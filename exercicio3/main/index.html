<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Felipe, B."><link href=https://felipebns.github.io/deeplearning_portfolio/exercicio3/main/ rel=canonical><link href=../../exercicio2/main/ rel=prev><link href=../../exercicio4/main/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.21"><title>Exercicio 3 - Portfolio de Felipe B</title><link rel=stylesheet href=../../assets/stylesheets/main.2a3383ac.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/_markdown_exec_ansi.css><link rel=stylesheet href=../../assets/stylesheets/badge.css><link rel=stylesheet href=../../termynal.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#grupo class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Portfolio de Felipe B" class="md-header__button md-logo" aria-label="Portfolio de Felipe B" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Portfolio de Felipe B </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Exercicio 3 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/felipebns/deeplearning_portfolio title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/documentation.template </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Portfolio de Felipe B" class="md-nav__button md-logo" aria-label="Portfolio de Felipe B" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> Portfolio de Felipe B </label> <div class=md-nav__source> <a href=https://github.com/felipebns/deeplearning_portfolio title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/documentation.template </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Exercicios </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Exercicios </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../exercicio1/main/ class=md-nav__link> <span class=md-ellipsis> Exercicio 1 </span> </a> </li> <li class=md-nav__item> <a href=../../exercicio2/main/ class=md-nav__link> <span class=md-ellipsis> Exercicio 2 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Exercicio 3 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Exercicio 3 </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#grupo class=md-nav__link> <span class=md-ellipsis> Grupo </span> </a> </li> <li class=md-nav__item> <a href=#entrega class=md-nav__link> <span class=md-ellipsis> Entrega </span> </a> </li> <li class=md-nav__item> <a href=#objetivo class=md-nav__link> <span class=md-ellipsis> Objetivo </span> </a> <nav class=md-nav aria-label=Objetivo> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tarefa-1 class=md-nav__link> <span class=md-ellipsis> Tarefa 1 </span> </a> </li> <li class=md-nav__item> <a href=#tarefa-2 class=md-nav__link> <span class=md-ellipsis> Tarefa 2 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nota-para-as-seguintes-tarefas-foi-utilizada-uma-mesma-mlp-que-da-conta-de-suprir-todas-as-necessidades-codigo-dela-no-final-da-pagina class=md-nav__link> <span class=md-ellipsis> Nota: para as seguintes tarefas foi utilizada uma mesma MLP que da conta de suprir todas as necessidades, código dela no final da página </span> </a> <nav class=md-nav aria-label="Nota: para as seguintes tarefas foi utilizada uma mesma MLP que da conta de suprir todas as necessidades, código dela no final da página"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tarefa-3 class=md-nav__link> <span class=md-ellipsis> Tarefa 3 </span> </a> </li> <li class=md-nav__item> <a href=#tarefa-4 class=md-nav__link> <span class=md-ellipsis> Tarefa 4 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../exercicio4/main/ class=md-nav__link> <span class=md-ellipsis> Exercicio 4 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Projeto </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Projeto </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../projeto/projeto1/main/ class=md-nav__link> <span class=md-ellipsis> Projeto 1 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#grupo class=md-nav__link> <span class=md-ellipsis> Grupo </span> </a> </li> <li class=md-nav__item> <a href=#entrega class=md-nav__link> <span class=md-ellipsis> Entrega </span> </a> </li> <li class=md-nav__item> <a href=#objetivo class=md-nav__link> <span class=md-ellipsis> Objetivo </span> </a> <nav class=md-nav aria-label=Objetivo> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tarefa-1 class=md-nav__link> <span class=md-ellipsis> Tarefa 1 </span> </a> </li> <li class=md-nav__item> <a href=#tarefa-2 class=md-nav__link> <span class=md-ellipsis> Tarefa 2 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#nota-para-as-seguintes-tarefas-foi-utilizada-uma-mesma-mlp-que-da-conta-de-suprir-todas-as-necessidades-codigo-dela-no-final-da-pagina class=md-nav__link> <span class=md-ellipsis> Nota: para as seguintes tarefas foi utilizada uma mesma MLP que da conta de suprir todas as necessidades, código dela no final da página </span> </a> <nav class=md-nav aria-label="Nota: para as seguintes tarefas foi utilizada uma mesma MLP que da conta de suprir todas as necessidades, código dela no final da página"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tarefa-3 class=md-nav__link> <span class=md-ellipsis> Tarefa 3 </span> </a> </li> <li class=md-nav__item> <a href=#tarefa-4 class=md-nav__link> <span class=md-ellipsis> Tarefa 4 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Exercicio 3</h1> <h2 id=grupo>Grupo</h2> <ol> <li>Felipe Bakowski Nantes de Souza</li> </ol> <h2 id=entrega>Entrega</h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Roteiro 3 - Data 21/09/2025</li> </ul> <h2 id=objetivo>Objetivo</h2> <p>Implementar um MLP e testá-lo em casos distintos. Ainda, validar o conhecimento em calcular forward propagation, back, loss, etc, manualmente</p> <h3 id=tarefa-1>Tarefa 1</h3> <p>Para os seguintes parâmetros:</p> <div class="language-text highlight"><pre><span></span><code>x = [0.5, -0.2]
y = 1

w1 = [[0.3, -0.1],
    [0.2,  0.4]]

b1 = [0.1, -0.2]

w2 = [0.5, -0.3]

b2 = 0.2

eta = 0.3

act func = tanh
</code></pre></div> <p>Calcule o forward pass, loss, backward pass e parameter update.</p> <p>Para tal utilizamos o seguinte código:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=c1># Manual calculation of MLP</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># Preparation</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.2</span><span class=p>])</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>y</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>w_hidden</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[</span><span class=mf>0.3</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.1</span><span class=p>],</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>                     <span class=p>[</span><span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.4</span><span class=p>]])</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=n>b_hidden</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.1</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.2</span><span class=p>])</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=n>w_out</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.5</span><span class=p>,</span> <span class=o>-</span><span class=mf>0.3</span><span class=p>])</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=n>b_out</span> <span class=o>=</span> <span class=mf>0.2</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=n>eta</span> <span class=o>=</span> <span class=mf>0.1</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=c1># === Forward pass ===</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=n>z_hidden</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w_hidden</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span> <span class=o>+</span> <span class=n>b_hidden</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=n>a_hidden</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z_hidden</span><span class=p>)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=n>z_out</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>w_out</span><span class=p>,</span> <span class=n>a_hidden</span><span class=p>)</span> <span class=o>+</span> <span class=n>b_out</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=n>y_out</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z_out</span><span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=n>loss</span> <span class=o>=</span> <span class=p>(</span><span class=n>y</span> <span class=o>-</span> <span class=n>y_out</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== FORWARD PASS ==="</span><span class=p>)</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Input x: </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Hidden pre-activation z_hidden: </span><span class=si>{</span><span class=n>z_hidden</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Hidden activation a_hidden (tanh): </span><span class=si>{</span><span class=n>a_hidden</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Output pre-activation z_out: </span><span class=si>{</span><span class=n>z_out</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Output y_out (tanh): </span><span class=si>{</span><span class=n>y_out</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Loss: </span><span class=si>{</span><span class=n>loss</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=c1># === Backward Pass ===</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=n>dloss_dy_out</span> <span class=o>=</span> <span class=o>-</span><span class=mi>2</span><span class=o>*</span><span class=p>(</span><span class=n>y</span> <span class=o>-</span> <span class=n>y_out</span><span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=n>dloss_dz_out</span> <span class=o>=</span> <span class=n>dloss_dy_out</span><span class=o>*</span><span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>y_out</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=n>dloss_dw_out1</span> <span class=o>=</span> <span class=n>dloss_dz_out</span><span class=o>*</span><span class=n>a_hidden</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=n>dloss_dw_out2</span> <span class=o>=</span> <span class=n>dloss_dz_out</span><span class=o>*</span><span class=n>a_hidden</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a><span class=n>dloss_db_out</span> <span class=o>=</span> <span class=n>dloss_dz_out</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=n>dloss_da_hidden1</span> <span class=o>=</span> <span class=n>dloss_dz_out</span><span class=o>*</span><span class=n>w_out</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=n>dloss_da_hidden2</span> <span class=o>=</span> <span class=n>dloss_dz_out</span><span class=o>*</span><span class=n>w_out</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=n>dloss_dz_hidden1</span> <span class=o>=</span> <span class=n>dloss_da_hidden1</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>a_hidden</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=n>dloss_dz_hidden2</span> <span class=o>=</span> <span class=n>dloss_da_hidden2</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>a_hidden</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a><span class=n>dloss_dw_hidden11</span> <span class=o>=</span> <span class=n>dloss_dz_hidden1</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a><span class=n>dloss_dw_hidden21</span> <span class=o>=</span> <span class=n>dloss_dz_hidden1</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=n>dloss_dw_hidden12</span> <span class=o>=</span> <span class=n>dloss_dz_hidden2</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=n>dloss_dw_hidden22</span> <span class=o>=</span> <span class=n>dloss_dz_hidden2</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a><span class=n>dloss_db_hidden1</span> <span class=o>=</span> <span class=n>dloss_dz_hidden1</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a><span class=n>dloss_db_hidden2</span> <span class=o>=</span> <span class=n>dloss_dz_hidden2</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a><span class=c1># === PRINT BACKPROP RESULTS ===</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== BACKWARD PASS ==="</span><span class=p>)</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"dL/dy_out: </span><span class=si>{</span><span class=n>dloss_dy_out</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"dL/dz_out: </span><span class=si>{</span><span class=n>dloss_dz_out</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>-- Gradientes saída --"</span><span class=p>)</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"dL/dw_out: [</span><span class=si>{</span><span class=n>dloss_dw_out1</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>dloss_dw_out2</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>]"</span><span class=p>)</span>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60 href=#__codelineno-0-60></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"dL/db_out: </span><span class=si>{</span><span class=n>dloss_db_out</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61 href=#__codelineno-0-61></a>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62 href=#__codelineno-0-62></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>-- Propagação para hidden --"</span><span class=p>)</span>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63 href=#__codelineno-0-63></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"dL/da_hidden: [</span><span class=si>{</span><span class=n>dloss_da_hidden1</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>dloss_da_hidden2</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>]"</span><span class=p>)</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64 href=#__codelineno-0-64></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"dL/dz_hidden: [</span><span class=si>{</span><span class=n>dloss_dz_hidden1</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>dloss_dz_hidden2</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>]"</span><span class=p>)</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65 href=#__codelineno-0-65></a>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66 href=#__codelineno-0-66></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>-- Gradientes hidden weights --"</span><span class=p>)</span>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67 href=#__codelineno-0-67></a><span class=n>grad_hidden</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68 href=#__codelineno-0-68></a>    <span class=p>[[</span><span class=n>dloss_dw_hidden11</span><span class=p>,</span> <span class=n>dloss_dw_hidden21</span><span class=p>],</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69 href=#__codelineno-0-69></a>     <span class=p>[</span><span class=n>dloss_dw_hidden12</span><span class=p>,</span> <span class=n>dloss_dw_hidden22</span><span class=p>]],</span>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70 href=#__codelineno-0-70></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s2>"x1"</span><span class=p>,</span> <span class=s2>"x2"</span><span class=p>],</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71 href=#__codelineno-0-71></a>    <span class=n>index</span><span class=o>=</span><span class=p>[</span><span class=s2>"h1"</span><span class=p>,</span> <span class=s2>"h2"</span><span class=p>]</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72 href=#__codelineno-0-72></a><span class=p>)</span>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73 href=#__codelineno-0-73></a><span class=nb>print</span><span class=p>(</span><span class=n>grad_hidden</span><span class=p>)</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74 href=#__codelineno-0-74></a>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75 href=#__codelineno-0-75></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>-- Gradientes hidden biases --"</span><span class=p>)</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76 href=#__codelineno-0-76></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"dL/db_hidden: [</span><span class=si>{</span><span class=n>dloss_db_hidden1</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>dloss_db_hidden2</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>]"</span><span class=p>)</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77 href=#__codelineno-0-77></a>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78 href=#__codelineno-0-78></a><span class=c1># ==== PARAMETER UPDATES =====</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79 href=#__codelineno-0-79></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== UPDATE PARAMETERS ==="</span><span class=p>)</span>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80 href=#__codelineno-0-80></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Antes da atualização:"</span><span class=p>)</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81 href=#__codelineno-0-81></a><span class=nb>print</span><span class=p>(</span><span class=s2>"w_hidden:</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span> <span class=n>w_hidden</span><span class=p>)</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82 href=#__codelineno-0-82></a><span class=nb>print</span><span class=p>(</span><span class=s2>"b_hidden:"</span><span class=p>,</span> <span class=n>b_hidden</span><span class=p>)</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83 href=#__codelineno-0-83></a><span class=nb>print</span><span class=p>(</span><span class=s2>"w_out:"</span><span class=p>,</span> <span class=n>w_out</span><span class=p>)</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84 href=#__codelineno-0-84></a><span class=nb>print</span><span class=p>(</span><span class=s2>"b_out:"</span><span class=p>,</span> <span class=n>b_out</span><span class=p>)</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85 href=#__codelineno-0-85></a>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86 href=#__codelineno-0-86></a><span class=c1># Atualização da camada escondida</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87 href=#__codelineno-0-87></a><span class=n>w_hidden</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_dw_hidden11</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88 href=#__codelineno-0-88></a><span class=n>w_hidden</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_dw_hidden21</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89 href=#__codelineno-0-89></a><span class=n>w_hidden</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_dw_hidden12</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90 href=#__codelineno-0-90></a><span class=n>w_hidden</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_dw_hidden22</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91 href=#__codelineno-0-91></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92 href=#__codelineno-0-92></a><span class=n>b_hidden</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_db_hidden1</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93 href=#__codelineno-0-93></a><span class=n>b_hidden</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_db_hidden2</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94 href=#__codelineno-0-94></a>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95 href=#__codelineno-0-95></a><span class=c1># Atualização da camada de saída</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96 href=#__codelineno-0-96></a><span class=n>w_out</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_dw_out1</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97 href=#__codelineno-0-97></a><span class=n>w_out</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_dw_out2</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98 href=#__codelineno-0-98></a><span class=n>b_out</span>    <span class=o>-=</span> <span class=n>eta</span> <span class=o>*</span> <span class=n>dloss_db_out</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99 href=#__codelineno-0-99></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100 href=#__codelineno-0-100></a><span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Depois da atualização:"</span><span class=p>)</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101 href=#__codelineno-0-101></a><span class=nb>print</span><span class=p>(</span><span class=s2>"w_hidden:</span><span class=se>\n</span><span class=s2>"</span><span class=p>,</span> <span class=n>w_hidden</span><span class=p>)</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102 href=#__codelineno-0-102></a><span class=nb>print</span><span class=p>(</span><span class=s2>"b_hidden:"</span><span class=p>,</span> <span class=n>b_hidden</span><span class=p>)</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103 href=#__codelineno-0-103></a><span class=nb>print</span><span class=p>(</span><span class=s2>"w_out:"</span><span class=p>,</span> <span class=n>w_out</span><span class=p>)</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104 href=#__codelineno-0-104></a><span class=nb>print</span><span class=p>(</span><span class=s2>"b_out:"</span><span class=p>,</span> <span class=n>b_out</span><span class=p>)</span>
</span></code></pre></div> <p>que gerou o seguinte output:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>=== FORWARD PASS ===
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>Input x: [ 0.5 -0.2]
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>Hidden pre-activation z_hidden: [ 0.27 -0.18]
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>Hidden activation a_hidden (tanh): [ 0.26362484 -0.17808087]
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>Output pre-activation z_out: 0.3852
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>Output y_out (tanh): 0.3672
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>Loss: 0.400377
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>=== BACKWARD PASS ===
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>dL/dy_out: -1.265507
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>dL/dz_out: -1.094828
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>-- Gradientes saída --
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>dL/dw_out: [-0.288624, 0.194968]
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>dL/db_out: -1.094828
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>-- Propagação para hidden --
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>dL/da_hidden: [-0.547414, 0.328448]
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>dL/dz_hidden: [-0.509370, 0.318032]
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>-- Gradientes hidden weights --
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>          x1        x2
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>h1 -0.254685  0.101874
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>h2  0.159016 -0.063606
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>-- Gradientes hidden biases --
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>dL/db_hidden: [-0.509370, 0.318032]
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>=== UPDATE PARAMETERS ===
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>Antes da atualização:
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>w_hidden:
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a> [[ 0.3 -0.1]
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a> [ 0.2  0.4]]
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a>b_hidden: [ 0.1 -0.2]
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>w_out: [ 0.5 -0.3]
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a>b_out: 0.2
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>Depois da atualização:
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a>w_hidden:
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a> [[ 0.32546849 -0.1101874 ]
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a> [ 0.18409838  0.40636065]]
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a>b_hidden: [ 0.15093698 -0.23180324]
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a>w_out: [ 0.52886238 -0.31949679]
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a>b_out: 0.30948279147136
</span></code></pre></div> <h3 id=tarefa-2>Tarefa 2</h3> <h2 id=nota-para-as-seguintes-tarefas-foi-utilizada-uma-mesma-mlp-que-da-conta-de-suprir-todas-as-necessidades-codigo-dela-no-final-da-pagina>Nota: para as seguintes tarefas foi utilizada uma mesma MLP que da conta de suprir todas as necessidades, código dela no final da página</h2> <p>Utilizando as seguintes especificações: </p> <p>N amostras: 1000</p> <p>N classes: 2</p> <p>N de clusters por classe: classe 0 -&gt; 1 cluster classe 1 -&gt; 2 clusters</p> <p>crie dados que seguem essas características e mande os resultado.</p> <p>Assim, o código para criar esses dados é o seguinte:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=kn>from</span><span class=w> </span><span class=nn>mlp</span><span class=w> </span><span class=kn>import</span> <span class=n>mlp</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=c1># ===== BINARY CLASSIFICATION (Exercise 2) =====</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c1># Classe 0: 1 cluster</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>X0</span><span class=p>,</span> <span class=n>y0</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=p>)</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=n>y0</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># força classe 0</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=c1># Classe 1: 2 clusters</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=n>X1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>24</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=p>)</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=n>y1</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># força classe 1</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=c1># Combina</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>([</span><span class=n>X0</span><span class=p>,</span> <span class=n>X1</span><span class=p>])</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>([</span><span class=n>y0</span><span class=p>,</span> <span class=n>y1</span><span class=p>])</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=c1># Split train/test (80/20)</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=c1># Cria MLP para classificação binária</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=n>mlp</span> <span class=o>=</span> <span class=n>mlp</span><span class=p>(</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>    <span class=n>n_hidden_layers</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a>    <span class=n>n_neurons_per_layer</span><span class=o>=</span><span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>  <span class=c1># hidden=4, output=1</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a>    <span class=n>activation</span><span class=o>=</span><span class=s1>'tanh'</span><span class=p>,</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a>    <span class=n>loss</span><span class=o>=</span><span class=s1>'mse'</span><span class=p>,</span> <span class=c1>#saida é binária, utilizamos mse</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s1>'gd'</span><span class=p>,</span>
</span><span id=__span-2-38><a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span>
</span><span id=__span-2-39><a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a>    <span class=n>eta</span><span class=o>=</span><span class=mf>0.1</span>
</span><span id=__span-2-40><a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=p>)</span>
</span><span id=__span-2-41><a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a>
</span><span id=__span-2-42><a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a><span class=c1># Treina</span>
</span><span id=__span-2-43><a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=n>mlp</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span><span id=__span-2-44><a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a>
</span><span id=__span-2-45><a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a><span class=c1># Testa e avalia</span>
</span><span id=__span-2-46><a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>test</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-2-47><a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=n>mlp</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>plot_confusion</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>plot_roc</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>preds</span><span class=o>=</span><span class=n>y_pred</span><span class=p>)</span>
</span></code></pre></div> <p>e o modelo resultante é o seguinte:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>=== Inicialização de Pesos e Biases ===
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>Camada 1:
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>W1 shape (4, 2):
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>[[ 0.06282189 -0.01995681]
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a> [-0.09948727 -0.08671114]
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a> [ 0.08370109 -0.10908174]
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a> [-0.01757068  0.09519239]]
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>b1 shape (4,):
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>[0. 0. 0. 0.]
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>Camada 2:
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>W2 shape (1, 4):
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>[[ 0.0665476  -0.14808445  0.11787561 -0.08045228]]
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>b2 shape (1,):
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>[0.]
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>Epoch 0, Loss: 0.200536
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a>Epoch 10, Loss: 0.137519
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a>Epoch 20, Loss: 0.135654
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>Epoch 30, Loss: 0.135681
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>Treinamento encerrado no epoch 35 (convergência detectada).
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a>Accuracy: 89.00%
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a>=== Pesos e Biases do Modelo ===
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>Camada 1:
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>  Pesos W1 (shape (4, 2)):
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a>[[ 0.01028162 -0.00596175]
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a> [-2.2332656  -2.97995227]
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a> [-1.69882465 -3.34039644]
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a> [-0.02222276  0.02191908]]
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>  Biases b1 (shape (4,)):
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a>[ 0.03770969  5.99630873 -1.43428069 -0.1020545 ]
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>Camada 2:
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a>  Pesos W2 (shape (1, 4)):
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a>[[-0.00147906 -0.91664343  0.8594697   0.00384365]]
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>  Biases b2 (shape (1,)):
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a>[1.97320113]
</span></code></pre></div> <p>Ainda, observa-se as imagens do roc curve e da matriz de confusão que deixam em evidência outras características do modelos</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../roc.png data-desc-position=bottom><img alt="roc curve" src=../roc.png></a></p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../confusion1.png data-desc-position=bottom><img alt=confusion1 src=../confusion1.png></a></p> <h3 id=tarefa-3>Tarefa 3</h3> <p>Muito parecido com a tarefa 2, utilizando as seguintes especificações: </p> <p>N amostras: 1500</p> <p>N classes: 3</p> <p>N features: 4</p> <p>N de clusters por classe: classe 0 -&gt; 2 cluster classe 1 -&gt; 3 clusters classe 2 -&gt; 4 clusters</p> <p>crie dados que seguem essas características e mande os resultado.</p> <p>Assim, o código para criar esses dados é o seguinte:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=kn>from</span><span class=w> </span><span class=nn>mlp</span><span class=w> </span><span class=kn>import</span> <span class=n>mlp</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=c1># ===== MULTI-CLASS CLASSIFICATION (Exercise 3) =====</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=c1># Classe 0: 2 clusters</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>X0</span><span class=p>,</span> <span class=n>y0</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=p>)</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=n>y0</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=c1># Classe 1: 3 clusters</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=n>X1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>24</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=p>)</span>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=n>y1</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=c1># Classe 2: 4 clusters</span>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=n>X2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>100</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=p>)</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=n>y2</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>2</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=c1># Combina</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>([</span><span class=n>X0</span><span class=p>,</span> <span class=n>X1</span><span class=p>,</span> <span class=n>X2</span><span class=p>])</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>([</span><span class=n>y0</span><span class=p>,</span> <span class=n>y1</span><span class=p>,</span> <span class=n>y2</span><span class=p>])</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=c1># Split train/test</span>
</span><span id=__span-4-36><a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-4-37><a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>
</span><span id=__span-4-38><a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a><span class=c1># Cria MLP para multi-class</span>
</span><span id=__span-4-39><a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a><span class=n>mlp</span> <span class=o>=</span> <span class=n>mlp</span><span class=p>(</span>
</span><span id=__span-4-40><a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
</span><span id=__span-4-41><a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a>    <span class=n>n_hidden_layers</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span><span id=__span-4-42><a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a>    <span class=n>n_neurons_per_layer</span><span class=o>=</span><span class=p>[</span><span class=mi>8</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>  <span class=c1># hidden=8, output=3 classes</span>
</span><span id=__span-4-43><a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a>    <span class=n>activation</span><span class=o>=</span><span class=s1>'tanh'</span><span class=p>,</span>
</span><span id=__span-4-44><a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a>    <span class=n>loss</span><span class=o>=</span><span class=s1>'cross_entropy'</span><span class=p>,</span>
</span><span id=__span-4-45><a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s1>'gd'</span><span class=p>,</span>
</span><span id=__span-4-46><a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>300</span><span class=p>,</span>
</span><span id=__span-4-47><a id=__codelineno-4-47 name=__codelineno-4-47 href=#__codelineno-4-47></a>    <span class=n>eta</span><span class=o>=</span><span class=mf>0.05</span>
</span><span id=__span-4-48><a id=__codelineno-4-48 name=__codelineno-4-48 href=#__codelineno-4-48></a><span class=p>)</span>
</span><span id=__span-4-49><a id=__codelineno-4-49 name=__codelineno-4-49 href=#__codelineno-4-49></a>
</span><span id=__span-4-50><a id=__codelineno-4-50 name=__codelineno-4-50 href=#__codelineno-4-50></a><span class=c1># Treina</span>
</span><span id=__span-4-51><a id=__codelineno-4-51 name=__codelineno-4-51 href=#__codelineno-4-51></a><span class=n>mlp</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span><span id=__span-4-52><a id=__codelineno-4-52 name=__codelineno-4-52 href=#__codelineno-4-52></a>
</span><span id=__span-4-53><a id=__codelineno-4-53 name=__codelineno-4-53 href=#__codelineno-4-53></a><span class=c1># Testa e avalia</span>
</span><span id=__span-4-54><a id=__codelineno-4-54 name=__codelineno-4-54 href=#__codelineno-4-54></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>mlp</span><span class=o>.</span><span class=n>test</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-4-55><a id=__codelineno-4-55 name=__codelineno-4-55 href=#__codelineno-4-55></a><span class=n>mlp</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>plot_confusion</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>plot_roc</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>preds</span><span class=o>=</span><span class=n>y_pred</span><span class=p>)</span>
</span></code></pre></div> <p>e o resultado foi o segiunte:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>=== Inicialização de Pesos e Biases ===
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>Camada 1:
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>W1 shape (8, 4):
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>[[-0.15012286  0.03636618  0.00755215  0.11669222]
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a> [-0.08320915  0.06254752 -0.06307116 -0.14782926]
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a> [ 0.0022151  -0.14332554 -0.05004609 -0.0201836 ]
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a> [-0.00959626 -0.08452745  0.06800672  0.04447651]
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a> [-0.06675591  0.02716564 -0.0402755   0.04110338]
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a> [ 0.01647392  0.23689506  0.13759678 -0.17216953]
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a> [ 0.13695956 -0.01969437 -0.02480733  0.06700953]
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a> [-0.1538137  -0.07199269 -0.23851082  0.08865847]]
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>b1 shape (8,):
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>[0. 0. 0. 0. 0. 0. 0. 0.]
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>Camada 2:
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>W2 shape (3, 8):
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>[[-0.03102423  0.14114412  0.12651862  0.0525337   0.00188353  0.0778287
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>   0.21716552 -0.10621928]
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a> [ 0.10797846 -0.00570225 -0.10403077  0.11305206 -0.0683529  -0.01938096
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>  -0.03513866  0.06930014]
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a> [ 0.07062139  0.14148664 -0.03282687 -0.04611272 -0.2125965   0.14508146
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a>  -0.13255499 -0.07127306]]
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a>b2 shape (3,):
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a>[0. 0. 0.]
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>Epoch 0, Loss: 0.426007
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a>Epoch 10, Loss: 0.199110
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a>Epoch 20, Loss: 0.153921
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>Epoch 30, Loss: 0.160203
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>Epoch 40, Loss: 0.164695
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>Epoch 50, Loss: 0.169913
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>Epoch 60, Loss: 0.173882
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a>Epoch 70, Loss: 0.171059
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>Epoch 80, Loss: 0.146784
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a>Epoch 90, Loss: 0.157961
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a>Epoch 100, Loss: 0.136661
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a>Epoch 110, Loss: 0.140420
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a>Epoch 120, Loss: 0.142970
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a>Epoch 130, Loss: 0.161925
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>Epoch 140, Loss: 0.174006
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a>Epoch 150, Loss: 0.124596
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a>Epoch 160, Loss: 0.127589
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a>Epoch 170, Loss: 0.133139
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a>Epoch 180, Loss: 0.136089
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a>Epoch 190, Loss: 0.127153
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a>Epoch 200, Loss: 0.152746
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a>Epoch 210, Loss: 0.140961
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48 href=#__codelineno-5-48></a>Epoch 220, Loss: 0.146886
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49 href=#__codelineno-5-49></a>Epoch 230, Loss: 0.117297
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50 href=#__codelineno-5-50></a>Epoch 240, Loss: 0.125047
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51 href=#__codelineno-5-51></a>Epoch 250, Loss: 0.118332
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52 href=#__codelineno-5-52></a>Epoch 260, Loss: 0.133416
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53 href=#__codelineno-5-53></a>Epoch 270, Loss: 0.157566
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54 href=#__codelineno-5-54></a>Epoch 280, Loss: 0.115870
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55 href=#__codelineno-5-55></a>Epoch 290, Loss: 0.141657
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56 href=#__codelineno-5-56></a>Accuracy: 94.33%
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57 href=#__codelineno-5-57></a>
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58 href=#__codelineno-5-58></a>=== Pesos e Biases do Modelo ===
</span><span id=__span-5-59><a id=__codelineno-5-59 name=__codelineno-5-59 href=#__codelineno-5-59></a>
</span><span id=__span-5-60><a id=__codelineno-5-60 name=__codelineno-5-60 href=#__codelineno-5-60></a>Camada 1:
</span><span id=__span-5-61><a id=__codelineno-5-61 name=__codelineno-5-61 href=#__codelineno-5-61></a>  Pesos W1 (shape (8, 4)):
</span><span id=__span-5-62><a id=__codelineno-5-62 name=__codelineno-5-62 href=#__codelineno-5-62></a>[[ -0.08576299  -0.95087168   2.55816272  13.44105675]
</span><span id=__span-5-63><a id=__codelineno-5-63 name=__codelineno-5-63 href=#__codelineno-5-63></a> [ -6.19685875  -1.0703442    0.06318581  -4.74594758]
</span><span id=__span-5-64><a id=__codelineno-5-64 name=__codelineno-5-64 href=#__codelineno-5-64></a> [ -0.30086178  -5.80590108  -3.15007815  -3.05409815]
</span><span id=__span-5-65><a id=__codelineno-5-65 name=__codelineno-5-65 href=#__codelineno-5-65></a> [ 10.22280012  -1.71382584   1.54665281   3.83600643]
</span><span id=__span-5-66><a id=__codelineno-5-66 name=__codelineno-5-66 href=#__codelineno-5-66></a> [ -0.67082362   1.81448785  -7.83430673  -2.71605366]
</span><span id=__span-5-67><a id=__codelineno-5-67 name=__codelineno-5-67 href=#__codelineno-5-67></a> [  3.42071321   9.41193187  -5.31067459   8.37335265]
</span><span id=__span-5-68><a id=__codelineno-5-68 name=__codelineno-5-68 href=#__codelineno-5-68></a> [ -5.95157244   0.94694413   0.79513151 -10.44803795]
</span><span id=__span-5-69><a id=__codelineno-5-69 name=__codelineno-5-69 href=#__codelineno-5-69></a> [ -3.83236454   1.58829969  -6.61690407   4.25813743]]
</span><span id=__span-5-70><a id=__codelineno-5-70 name=__codelineno-5-70 href=#__codelineno-5-70></a>  Biases b1 (shape (8,)):
</span><span id=__span-5-71><a id=__codelineno-5-71 name=__codelineno-5-71 href=#__codelineno-5-71></a>[  2.98018584  -8.2687564  -17.15145087   3.00833864  -2.61779085
</span><span id=__span-5-72><a id=__codelineno-5-72 name=__codelineno-5-72 href=#__codelineno-5-72></a> -18.47840645   4.66698319  -1.45933255]
</span><span id=__span-5-73><a id=__codelineno-5-73 name=__codelineno-5-73 href=#__codelineno-5-73></a>
</span><span id=__span-5-74><a id=__codelineno-5-74 name=__codelineno-5-74 href=#__codelineno-5-74></a>Camada 2:
</span><span id=__span-5-75><a id=__codelineno-5-75 name=__codelineno-5-75 href=#__codelineno-5-75></a>  Pesos W2 (shape (3, 8)):
</span><span id=__span-5-76><a id=__codelineno-5-76 name=__codelineno-5-76 href=#__codelineno-5-76></a>[[-3.08806844 -0.40361496  2.68544436 -1.59783599  1.93742736  0.79406231
</span><span id=__span-5-77><a id=__codelineno-5-77 name=__codelineno-5-77 href=#__codelineno-5-77></a>   1.26835691  1.03757026]
</span><span id=__span-5-78><a id=__codelineno-5-78 name=__codelineno-5-78 href=#__codelineno-5-78></a> [ 1.12279544 -0.83468701 -0.32344479  1.70018782 -1.86252433  3.18272202
</span><span id=__span-5-79><a id=__codelineno-5-79 name=__codelineno-5-79 href=#__codelineno-5-79></a>   1.1324417   0.35434438]
</span><span id=__span-5-80><a id=__codelineno-5-80 name=__codelineno-5-80 href=#__codelineno-5-80></a> [ 2.11284863  1.51523047 -2.37233858  0.01712121 -0.35396892 -3.77325513
</span><span id=__span-5-81><a id=__codelineno-5-81 name=__codelineno-5-81 href=#__codelineno-5-81></a>  -2.35132674 -1.50010685]]
</span><span id=__span-5-82><a id=__codelineno-5-82 name=__codelineno-5-82 href=#__codelineno-5-82></a>  Biases b2 (shape (3,)):
</span><span id=__span-5-83><a id=__codelineno-5-83 name=__codelineno-5-83 href=#__codelineno-5-83></a>[-1.54010396  2.56898611 -1.02888214]
</span></code></pre></div> <p>Ainda, observa-se a imagen da matriz de confusão que deixa em evidência outras características do modelos</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../confusion2.png data-desc-position=bottom><img alt=confusion2 src=../confusion2.png></a></p> <h3 id=tarefa-4>Tarefa 4</h3> <p>Por fim, repetiremos a mesma coisa do exercício 3, mas com 2 camadas ocultas.</p> <p>O código para tal foi: </p> <div class="language-python highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>make_classification</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.model_selection</span><span class=w> </span><span class=kn>import</span> <span class=n>train_test_split</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=kn>from</span><span class=w> </span><span class=nn>mlp</span><span class=w> </span><span class=kn>import</span> <span class=n>mlp</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=c1># ===== MULTI-CLASS CLASSIFICATION (Exercise 4) =====</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=c1># Classe 0: 2 clusters</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=n>X0</span><span class=p>,</span> <span class=n>y0</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=p>)</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=n>y0</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=c1># Classe 1: 3 clusters</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=n>X1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>24</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=p>)</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=n>y1</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=c1># Classe 2: 4 clusters</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=n>X2</span><span class=p>,</span> <span class=n>y2</span> <span class=o>=</span> <span class=n>make_classification</span><span class=p>(</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>    <span class=n>n_samples</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>n_classes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_clusters_per_class</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_informative</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>n_redundant</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a>    <span class=n>class_sep</span><span class=o>=</span><span class=mf>2.0</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>100</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=p>)</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a><span class=n>y2</span><span class=p>[:]</span> <span class=o>=</span> <span class=mi>2</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=c1># Combina</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=n>X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>([</span><span class=n>X0</span><span class=p>,</span> <span class=n>X1</span><span class=p>,</span> <span class=n>X2</span><span class=p>])</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>([</span><span class=n>y0</span><span class=p>,</span> <span class=n>y1</span><span class=p>,</span> <span class=n>y2</span><span class=p>])</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a><span class=c1># Split train/test</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a><span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a><span class=c1># Cria MLP para multi-class</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a><span class=c1># ===== MULTI-CLASS WITH DEEPER MLP (Exercise 4) =====</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a><span class=n>mlp_deep</span> <span class=o>=</span> <span class=n>mlp</span><span class=p>(</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a>    <span class=n>n_features</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41 href=#__codelineno-6-41></a>    <span class=n>n_hidden_layers</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42 href=#__codelineno-6-42></a>    <span class=n>n_neurons_per_layer</span><span class=o>=</span><span class=p>[</span><span class=mi>16</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>  <span class=c1># duas hidden layers</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43 href=#__codelineno-6-43></a>    <span class=n>activation</span><span class=o>=</span><span class=s1>'relu'</span><span class=p>,</span> <span class=c1>#relu melhora performance</span>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44 href=#__codelineno-6-44></a>    <span class=n>loss</span><span class=o>=</span><span class=s1>'cross_entropy'</span><span class=p>,</span>
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45 href=#__codelineno-6-45></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s1>'gd'</span><span class=p>,</span>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46 href=#__codelineno-6-46></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=c1>#mais epochs por ser maior</span>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47 href=#__codelineno-6-47></a>    <span class=n>eta</span><span class=o>=</span><span class=mf>0.01</span>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48 href=#__codelineno-6-48></a><span class=p>)</span>
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49 href=#__codelineno-6-49></a>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50 href=#__codelineno-6-50></a><span class=n>mlp_deep</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51 href=#__codelineno-6-51></a>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52 href=#__codelineno-6-52></a><span class=n>y_pred</span> <span class=o>=</span> <span class=n>mlp_deep</span><span class=o>.</span><span class=n>test</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53 href=#__codelineno-6-53></a><span class=n>mlp_deep</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>plot_confusion</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>plot_roc</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>preds</span><span class=o>=</span><span class=n>y_pred</span><span class=p>)</span>
</span></code></pre></div> <p>e o resultado foi o seguinte:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>=== Inicialização de Pesos e Biases ===
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>Camada 1:
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>W1 shape (16, 4):
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>[[ 0.00555123  0.02945733  0.00320483  0.14107248]
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a> [ 0.01309987 -0.14536763 -0.24914801 -0.1097325 ]
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a> [ 0.13263989 -0.00845282  0.04363311 -0.20942593]
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a> [ 0.06151256  0.17526377  0.06525152 -0.143594  ]
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a> [ 0.19053969  0.05164986 -0.06384301 -0.13528166]
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a> [-0.01802708 -0.06539238 -0.23653229 -0.06647837]
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a> [-0.1773437   0.18719514 -0.2432306  -0.13664237]
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a> [-0.03559021  0.09356135  0.00909633 -0.02496799]
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a> [-0.010703   -0.05643333  0.14452321 -0.12340063]
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a> [-0.11520311  0.12193497 -0.01601216 -0.04162409]
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a> [ 0.10112067 -0.06794277 -0.09689412 -0.07876592]
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a> [ 0.10129985  0.13837398 -0.0192343   0.28110855]
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a> [ 0.06734521  0.04200509  0.06857739 -0.0089593 ]
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a> [ 0.03230203 -0.086233    0.05157866 -0.08939185]
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a> [-0.05631417  0.09558788  0.03310292 -0.03783207]
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a> [ 0.26892547 -0.0355394  -0.23973207  0.12095571]]
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>b1 shape (16,):
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>Camada 2:
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>W2 shape (8, 16):
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>[[ 0.02722147  0.07925187 -0.08892502  0.07395878 -0.03866726  0.04836275
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>   0.03062031 -0.01350536  0.00136201  0.0866263  -0.11018394 -0.00879913
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>   0.04369193  0.08227613  0.0774328   0.06628226]
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a> [-0.00382254 -0.04122877 -0.12089201 -0.09174723  0.28529764  0.04758449
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>  -0.12776212  0.00118261 -0.22349046  0.18041981 -0.01872715 -0.05201189
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>   0.00592675  0.01669519  0.11267001  0.06858279]
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a> [ 0.0127937  -0.03001005  0.01187981 -0.0564881   0.07511489 -0.34500628
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>  -0.07107095  0.11538678 -0.01051689  0.0867737   0.15186372  0.04087284
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a>   0.06905849  0.14079224 -0.18074581  0.06372337]
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a> [-0.04562775  0.01619738 -0.0616143   0.00100512  0.13642802 -0.06340487
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a>   0.13042471 -0.02625564 -0.06957138 -0.0269656  -0.08705771 -0.11467694
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a>  -0.02810464  0.08168548  0.03388796  0.13286287]
</span><span id=__span-7-37><a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a> [ 0.08442033  0.23117066 -0.06388346  0.04641671 -0.01899345  0.03415299
</span><span id=__span-7-38><a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a>  -0.15404318  0.01264817  0.08692396 -0.13046417 -0.07150701 -0.1247061
</span><span id=__span-7-39><a id=__codelineno-7-39 name=__codelineno-7-39 href=#__codelineno-7-39></a>   0.11768296  0.08659426 -0.07457327  0.02828019]
</span><span id=__span-7-40><a id=__codelineno-7-40 name=__codelineno-7-40 href=#__codelineno-7-40></a> [-0.00576693  0.01818947 -0.04820858 -0.07797701  0.00879961  0.04139584
</span><span id=__span-7-41><a id=__codelineno-7-41 name=__codelineno-7-41 href=#__codelineno-7-41></a>   0.0744317  -0.00071307 -0.0222676  -0.05408615  0.0778405   0.15156107
</span><span id=__span-7-42><a id=__codelineno-7-42 name=__codelineno-7-42 href=#__codelineno-7-42></a>  -0.17894417 -0.06650762 -0.14505942 -0.0273448 ]
</span><span id=__span-7-43><a id=__codelineno-7-43 name=__codelineno-7-43 href=#__codelineno-7-43></a> [ 0.13834086  0.06803163 -0.07831411 -0.11383326 -0.19915929  0.05239984
</span><span id=__span-7-44><a id=__codelineno-7-44 name=__codelineno-7-44 href=#__codelineno-7-44></a>  -0.06936135 -0.13220569 -0.09276729  0.10489427  0.01956362  0.08235377
</span><span id=__span-7-45><a id=__codelineno-7-45 name=__codelineno-7-45 href=#__codelineno-7-45></a>   0.16126182 -0.24129253 -0.1078609  -0.07034368]
</span><span id=__span-7-46><a id=__codelineno-7-46 name=__codelineno-7-46 href=#__codelineno-7-46></a> [-0.00679845  0.11362595 -0.0065863   0.0774349   0.12396009  0.14655074
</span><span id=__span-7-47><a id=__codelineno-7-47 name=__codelineno-7-47 href=#__codelineno-7-47></a>  -0.16693398 -0.21766298  0.08333175  0.11371362 -0.27184616 -0.19571742
</span><span id=__span-7-48><a id=__codelineno-7-48 name=__codelineno-7-48 href=#__codelineno-7-48></a>   0.05006519 -0.02464831  0.0496306   0.13814309]]
</span><span id=__span-7-49><a id=__codelineno-7-49 name=__codelineno-7-49 href=#__codelineno-7-49></a>b2 shape (8,):
</span><span id=__span-7-50><a id=__codelineno-7-50 name=__codelineno-7-50 href=#__codelineno-7-50></a>[0. 0. 0. 0. 0. 0. 0. 0.]
</span><span id=__span-7-51><a id=__codelineno-7-51 name=__codelineno-7-51 href=#__codelineno-7-51></a>
</span><span id=__span-7-52><a id=__codelineno-7-52 name=__codelineno-7-52 href=#__codelineno-7-52></a>Camada 3:
</span><span id=__span-7-53><a id=__codelineno-7-53 name=__codelineno-7-53 href=#__codelineno-7-53></a>W3 shape (3, 8):
</span><span id=__span-7-54><a id=__codelineno-7-54 name=__codelineno-7-54 href=#__codelineno-7-54></a>[[ 0.13737013 -0.00819777  0.05503834  0.02554672 -0.07860347 -0.16416347
</span><span id=__span-7-55><a id=__codelineno-7-55 name=__codelineno-7-55 href=#__codelineno-7-55></a>  -0.05241293 -0.12545059]
</span><span id=__span-7-56><a id=__codelineno-7-56 name=__codelineno-7-56 href=#__codelineno-7-56></a> [ 0.08305538 -0.02370211 -0.00149418  0.12830182 -0.07896425 -0.0304211
</span><span id=__span-7-57><a id=__codelineno-7-57 name=__codelineno-7-57 href=#__codelineno-7-57></a>   0.03274002  0.02992113]
</span><span id=__span-7-58><a id=__codelineno-7-58 name=__codelineno-7-58 href=#__codelineno-7-58></a> [ 0.14912918  0.04469714  0.01246757  0.01173774 -0.03409813 -0.12439819
</span><span id=__span-7-59><a id=__codelineno-7-59 name=__codelineno-7-59 href=#__codelineno-7-59></a>  -0.01339562  0.04655981]]
</span><span id=__span-7-60><a id=__codelineno-7-60 name=__codelineno-7-60 href=#__codelineno-7-60></a>b3 shape (3,):
</span><span id=__span-7-61><a id=__codelineno-7-61 name=__codelineno-7-61 href=#__codelineno-7-61></a>[0. 0. 0.]
</span><span id=__span-7-62><a id=__codelineno-7-62 name=__codelineno-7-62 href=#__codelineno-7-62></a>
</span><span id=__span-7-63><a id=__codelineno-7-63 name=__codelineno-7-63 href=#__codelineno-7-63></a>Epoch 0, Loss: 0.888729
</span><span id=__span-7-64><a id=__codelineno-7-64 name=__codelineno-7-64 href=#__codelineno-7-64></a>Epoch 10, Loss: 0.144946
</span><span id=__span-7-65><a id=__codelineno-7-65 name=__codelineno-7-65 href=#__codelineno-7-65></a>Epoch 20, Loss: 0.113786
</span><span id=__span-7-66><a id=__codelineno-7-66 name=__codelineno-7-66 href=#__codelineno-7-66></a>Epoch 30, Loss: 0.095721
</span><span id=__span-7-67><a id=__codelineno-7-67 name=__codelineno-7-67 href=#__codelineno-7-67></a>Epoch 40, Loss: 0.083704
</span><span id=__span-7-68><a id=__codelineno-7-68 name=__codelineno-7-68 href=#__codelineno-7-68></a>Epoch 50, Loss: 0.075874
</span><span id=__span-7-69><a id=__codelineno-7-69 name=__codelineno-7-69 href=#__codelineno-7-69></a>Epoch 60, Loss: 0.070778
</span><span id=__span-7-70><a id=__codelineno-7-70 name=__codelineno-7-70 href=#__codelineno-7-70></a>Epoch 70, Loss: 0.066706
</span><span id=__span-7-71><a id=__codelineno-7-71 name=__codelineno-7-71 href=#__codelineno-7-71></a>Epoch 80, Loss: 0.064859
</span><span id=__span-7-72><a id=__codelineno-7-72 name=__codelineno-7-72 href=#__codelineno-7-72></a>Epoch 90, Loss: 0.062447
</span><span id=__span-7-73><a id=__codelineno-7-73 name=__codelineno-7-73 href=#__codelineno-7-73></a>Epoch 100, Loss: 0.058853
</span><span id=__span-7-74><a id=__codelineno-7-74 name=__codelineno-7-74 href=#__codelineno-7-74></a>Epoch 110, Loss: 0.060413
</span><span id=__span-7-75><a id=__codelineno-7-75 name=__codelineno-7-75 href=#__codelineno-7-75></a>Epoch 120, Loss: 0.058912
</span><span id=__span-7-76><a id=__codelineno-7-76 name=__codelineno-7-76 href=#__codelineno-7-76></a>Epoch 130, Loss: 0.057664
</span><span id=__span-7-77><a id=__codelineno-7-77 name=__codelineno-7-77 href=#__codelineno-7-77></a>Epoch 140, Loss: 0.059227
</span><span id=__span-7-78><a id=__codelineno-7-78 name=__codelineno-7-78 href=#__codelineno-7-78></a>Epoch 150, Loss: 0.066484
</span><span id=__span-7-79><a id=__codelineno-7-79 name=__codelineno-7-79 href=#__codelineno-7-79></a>Epoch 160, Loss: 0.058584
</span><span id=__span-7-80><a id=__codelineno-7-80 name=__codelineno-7-80 href=#__codelineno-7-80></a>Epoch 170, Loss: 0.093342
</span><span id=__span-7-81><a id=__codelineno-7-81 name=__codelineno-7-81 href=#__codelineno-7-81></a>Epoch 180, Loss: 0.057734
</span><span id=__span-7-82><a id=__codelineno-7-82 name=__codelineno-7-82 href=#__codelineno-7-82></a>Epoch 190, Loss: 0.128726
</span><span id=__span-7-83><a id=__codelineno-7-83 name=__codelineno-7-83 href=#__codelineno-7-83></a>Epoch 200, Loss: 0.051217
</span><span id=__span-7-84><a id=__codelineno-7-84 name=__codelineno-7-84 href=#__codelineno-7-84></a>Epoch 210, Loss: 0.050794
</span><span id=__span-7-85><a id=__codelineno-7-85 name=__codelineno-7-85 href=#__codelineno-7-85></a>Epoch 220, Loss: 0.049839
</span><span id=__span-7-86><a id=__codelineno-7-86 name=__codelineno-7-86 href=#__codelineno-7-86></a>Treinamento encerrado no epoch 229 (convergência detectada).
</span><span id=__span-7-87><a id=__codelineno-7-87 name=__codelineno-7-87 href=#__codelineno-7-87></a>Accuracy: 95.33%
</span><span id=__span-7-88><a id=__codelineno-7-88 name=__codelineno-7-88 href=#__codelineno-7-88></a>
</span><span id=__span-7-89><a id=__codelineno-7-89 name=__codelineno-7-89 href=#__codelineno-7-89></a>=== Pesos e Biases do Modelo ===
</span><span id=__span-7-90><a id=__codelineno-7-90 name=__codelineno-7-90 href=#__codelineno-7-90></a>
</span><span id=__span-7-91><a id=__codelineno-7-91 name=__codelineno-7-91 href=#__codelineno-7-91></a>Camada 1:
</span><span id=__span-7-92><a id=__codelineno-7-92 name=__codelineno-7-92 href=#__codelineno-7-92></a>  Pesos W1 (shape (16, 4)):
</span><span id=__span-7-93><a id=__codelineno-7-93 name=__codelineno-7-93 href=#__codelineno-7-93></a>[[ 0.45449009 -0.81209545  0.87507731  2.18683697]
</span><span id=__span-7-94><a id=__codelineno-7-94 name=__codelineno-7-94 href=#__codelineno-7-94></a> [ 0.15004802 -1.01112088 -1.15337974 -0.09514862]
</span><span id=__span-7-95><a id=__codelineno-7-95 name=__codelineno-7-95 href=#__codelineno-7-95></a> [ 0.45935796 -0.10834158  0.70303986 -0.84685614]
</span><span id=__span-7-96><a id=__codelineno-7-96 name=__codelineno-7-96 href=#__codelineno-7-96></a> [ 0.29513792  0.05772944  0.58649792 -1.05736521]
</span><span id=__span-7-97><a id=__codelineno-7-97 name=__codelineno-7-97 href=#__codelineno-7-97></a> [ 1.6703515   0.18208112 -0.81806201 -1.72391369]
</span><span id=__span-7-98><a id=__codelineno-7-98 name=__codelineno-7-98 href=#__codelineno-7-98></a> [ 0.80567936 -0.82451442 -1.20037685 -0.09512992]
</span><span id=__span-7-99><a id=__codelineno-7-99 name=__codelineno-7-99 href=#__codelineno-7-99></a> [ 0.62185923  0.21451844 -1.55916952 -2.36866482]
</span><span id=__span-7-100><a id=__codelineno-7-100 name=__codelineno-7-100 href=#__codelineno-7-100></a> [ 1.05418959  0.38149916 -0.36325671 -0.84923767]
</span><span id=__span-7-101><a id=__codelineno-7-101 name=__codelineno-7-101 href=#__codelineno-7-101></a> [ 0.29519694  0.20959077  0.75808654 -1.12321373]
</span><span id=__span-7-102><a id=__codelineno-7-102 name=__codelineno-7-102 href=#__codelineno-7-102></a> [ 0.4891369   0.88976757  0.41393927  0.29881998]
</span><span id=__span-7-103><a id=__codelineno-7-103 name=__codelineno-7-103 href=#__codelineno-7-103></a> [ 0.12312357 -1.36602    -0.69411203 -1.17632493]
</span><span id=__span-7-104><a id=__codelineno-7-104 name=__codelineno-7-104 href=#__codelineno-7-104></a> [ 0.19580783  1.83502988 -1.02093175  1.60552112]
</span><span id=__span-7-105><a id=__codelineno-7-105 name=__codelineno-7-105 href=#__codelineno-7-105></a> [ 1.87435417 -0.05828504 -0.24050461 -0.84568474]
</span><span id=__span-7-106><a id=__codelineno-7-106 name=__codelineno-7-106 href=#__codelineno-7-106></a> [-1.60272002 -2.22218284  0.37665507 -1.51703194]
</span><span id=__span-7-107><a id=__codelineno-7-107 name=__codelineno-7-107 href=#__codelineno-7-107></a> [-1.52787748  0.50375896  0.82300988 -1.06078257]
</span><span id=__span-7-108><a id=__codelineno-7-108 name=__codelineno-7-108 href=#__codelineno-7-108></a> [ 1.70029325  0.05272135 -0.68866116 -0.77060775]]
</span><span id=__span-7-109><a id=__codelineno-7-109 name=__codelineno-7-109 href=#__codelineno-7-109></a>  Biases b1 (shape (16,)):
</span><span id=__span-7-110><a id=__codelineno-7-110 name=__codelineno-7-110 href=#__codelineno-7-110></a>[ 2.87506729 -0.97097384 -1.03208891 -1.01666649 -1.4237539  -0.35824997
</span><span id=__span-7-111><a id=__codelineno-7-111 name=__codelineno-7-111 href=#__codelineno-7-111></a> -1.38646553  1.11117524 -0.6571113   1.04982543 -2.19095566 -1.95947317
</span><span id=__span-7-112><a id=__codelineno-7-112 name=__codelineno-7-112 href=#__codelineno-7-112></a> -0.77506652 -2.87308326 -2.07890379 -0.5416115 ]
</span><span id=__span-7-113><a id=__codelineno-7-113 name=__codelineno-7-113 href=#__codelineno-7-113></a>
</span><span id=__span-7-114><a id=__codelineno-7-114 name=__codelineno-7-114 href=#__codelineno-7-114></a>Camada 2:
</span><span id=__span-7-115><a id=__codelineno-7-115 name=__codelineno-7-115 href=#__codelineno-7-115></a>  Pesos W2 (shape (8, 16)):
</span><span id=__span-7-116><a id=__codelineno-7-116 name=__codelineno-7-116 href=#__codelineno-7-116></a>[[-2.51653145  0.99919717  0.31172912  0.24975674 -0.84081024  1.10991394
</span><span id=__span-7-117><a id=__codelineno-7-117 name=__codelineno-7-117 href=#__codelineno-7-117></a>   1.43743357  0.25522576 -0.2741374  -0.14056338 -0.31440857  1.01651237
</span><span id=__span-7-118><a id=__codelineno-7-118 name=__codelineno-7-118 href=#__codelineno-7-118></a>  -0.87982114  1.1778178  -0.48786285 -0.77717119]
</span><span id=__span-7-119><a id=__codelineno-7-119 name=__codelineno-7-119 href=#__codelineno-7-119></a> [ 0.709298   -0.60106447 -0.32317526 -0.3917947   0.35926835 -0.24484754
</span><span id=__span-7-120><a id=__codelineno-7-120 name=__codelineno-7-120 href=#__codelineno-7-120></a>  -0.58428285 -0.41805447 -0.29338005 -0.05474837 -0.00984989 -0.92817564
</span><span id=__span-7-121><a id=__codelineno-7-121 name=__codelineno-7-121 href=#__codelineno-7-121></a>   0.40831344 -0.60530097  0.54390647  0.39381455]
</span><span id=__span-7-122><a id=__codelineno-7-122 name=__codelineno-7-122 href=#__codelineno-7-122></a> [ 0.24014628 -0.29199683  0.62213453  0.5360135   0.08783817 -0.76775864
</span><span id=__span-7-123><a id=__codelineno-7-123 name=__codelineno-7-123 href=#__codelineno-7-123></a>  -0.58087863  0.47373031  0.35525185 -0.05466441  1.14555677  0.51674229
</span><span id=__span-7-124><a id=__codelineno-7-124 name=__codelineno-7-124 href=#__codelineno-7-124></a>   0.60707751  0.7570584  -1.64252534 -0.13220308]
</span><span id=__span-7-125><a id=__codelineno-7-125 name=__codelineno-7-125 href=#__codelineno-7-125></a> [-0.04050464  0.09946613  0.03482787 -0.10076799  0.28732381  0.04671199
</span><span id=__span-7-126><a id=__codelineno-7-126 name=__codelineno-7-126 href=#__codelineno-7-126></a>   0.44368948  0.43547368 -0.06179928 -0.51690552  0.12609127 -0.23247329
</span><span id=__span-7-127><a id=__codelineno-7-127 name=__codelineno-7-127 href=#__codelineno-7-127></a>  -0.1159861   0.67172455 -1.30794824  0.0698007 ]
</span><span id=__span-7-128><a id=__codelineno-7-128 name=__codelineno-7-128 href=#__codelineno-7-128></a> [ 1.24695253  0.83649761 -0.57498506 -0.70753726  0.1505899   0.14347617
</span><span id=__span-7-129><a id=__codelineno-7-129 name=__codelineno-7-129 href=#__codelineno-7-129></a>  -1.44053883 -0.56842254 -0.09376871 -1.5549557  -1.03014594 -0.60825075
</span><span id=__span-7-130><a id=__codelineno-7-130 name=__codelineno-7-130 href=#__codelineno-7-130></a>   0.87014556 -1.55513437  1.74632994  0.96480407]
</span><span id=__span-7-131><a id=__codelineno-7-131 name=__codelineno-7-131 href=#__codelineno-7-131></a> [ 0.48371643 -1.55354945 -0.29322351 -0.36287776 -0.36833393 -1.0432472
</span><span id=__span-7-132><a id=__codelineno-7-132 name=__codelineno-7-132 href=#__codelineno-7-132></a>   0.34752016  0.15123585 -1.36247718  0.20055968 -0.12145993  1.73818686
</span><span id=__span-7-133><a id=__codelineno-7-133 name=__codelineno-7-133 href=#__codelineno-7-133></a>  -0.93640658 -1.61837592 -0.31875254 -0.50648797]
</span><span id=__span-7-134><a id=__codelineno-7-134 name=__codelineno-7-134 href=#__codelineno-7-134></a> [-0.71046805 -0.10557216  0.24102679 -0.14443525  0.05043702  0.64160379
</span><span id=__span-7-135><a id=__codelineno-7-135 name=__codelineno-7-135 href=#__codelineno-7-135></a>  -1.51711324 -1.26195373 -0.10748288 -0.84382939  0.59926703  1.08691862
</span><span id=__span-7-136><a id=__codelineno-7-136 name=__codelineno-7-136 href=#__codelineno-7-136></a>   0.96846356 -0.60474557  0.04744151  0.4188    ]
</span><span id=__span-7-137><a id=__codelineno-7-137 name=__codelineno-7-137 href=#__codelineno-7-137></a> [ 1.38642778 -1.24039498  0.68059487  0.52950407  1.29769176 -0.85891872
</span><span id=__span-7-138><a id=__codelineno-7-138 name=__codelineno-7-138 href=#__codelineno-7-138></a>   0.07171113 -0.90756691  0.34135117 -0.22156202 -1.4636656   0.52030564
</span><span id=__span-7-139><a id=__codelineno-7-139 name=__codelineno-7-139 href=#__codelineno-7-139></a>   0.50227455  0.73556049  0.11386068  0.98848203]]
</span><span id=__span-7-140><a id=__codelineno-7-140 name=__codelineno-7-140 href=#__codelineno-7-140></a>  Biases b2 (shape (8,)):
</span><span id=__span-7-141><a id=__codelineno-7-141 name=__codelineno-7-141 href=#__codelineno-7-141></a>[-0.18439159 -0.42846032  0.30690122 -0.22516767  0.34530631  0.84354255
</span><span id=__span-7-142><a id=__codelineno-7-142 name=__codelineno-7-142 href=#__codelineno-7-142></a>  1.55199328  0.36290337]
</span><span id=__span-7-143><a id=__codelineno-7-143 name=__codelineno-7-143 href=#__codelineno-7-143></a>
</span><span id=__span-7-144><a id=__codelineno-7-144 name=__codelineno-7-144 href=#__codelineno-7-144></a>Camada 3:
</span><span id=__span-7-145><a id=__codelineno-7-145 name=__codelineno-7-145 href=#__codelineno-7-145></a>  Pesos W3 (shape (3, 8)):
</span><span id=__span-7-146><a id=__codelineno-7-146 name=__codelineno-7-146 href=#__codelineno-7-146></a>[[ 1.72233185 -0.52519902 -0.01990436  0.33143588  0.58155462  0.12188458
</span><span id=__span-7-147><a id=__codelineno-7-147 name=__codelineno-7-147 href=#__codelineno-7-147></a>  -1.45734643 -0.83036462]
</span><span id=__span-7-148><a id=__codelineno-7-148 name=__codelineno-7-148 href=#__codelineno-7-148></a> [-2.46311209 -0.24225901  0.58411664  0.21919931 -1.52323223  1.42755525
</span><span id=__span-7-149><a id=__codelineno-7-149 name=__codelineno-7-149 href=#__codelineno-7-149></a>   1.22172185  0.39356433]
</span><span id=__span-7-150><a id=__codelineno-7-150 name=__codelineno-7-150 href=#__codelineno-7-150></a> [ 1.11033493  0.78025528 -0.49820055 -0.38504892  0.75001176 -1.86842258
</span><span id=__span-7-151><a id=__codelineno-7-151 name=__codelineno-7-151 href=#__codelineno-7-151></a>   0.20255606  0.38783064]]
</span><span id=__span-7-152><a id=__codelineno-7-152 name=__codelineno-7-152 href=#__codelineno-7-152></a>  Biases b3 (shape (3,)):
</span><span id=__span-7-153><a id=__codelineno-7-153 name=__codelineno-7-153 href=#__codelineno-7-153></a>[-0.3177156  -0.17096346  0.48867906]
</span></code></pre></div> <p>Ainda, observa-se a imagen da matriz de confusão que deixa em evidência outras características do modelos</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../confusion3.png data-desc-position=bottom><img alt=confusion3 src=../confusion3.png></a></p> <p>Por última, esse é o código da MLP que foi implementada:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>confusion_matrix</span><span class=p>,</span> <span class=n>roc_curve</span><span class=p>,</span> <span class=n>auc</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=k>class</span><span class=w> </span><span class=nc>mlp</span><span class=p>:</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n_features</span><span class=p>:</span><span class=nb>int</span><span class=p>,</span> <span class=n>n_hidden_layers</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>n_neurons_per_layer</span><span class=p>:</span> <span class=nb>list</span><span class=p>,</span> 
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>                <span class=n>activation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>loss</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>optimizer</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>epochs</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>eta</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_features</span> <span class=o>=</span> <span class=n>n_features</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_hidden_layers</span> <span class=o>=</span> <span class=n>n_hidden_layers</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_neurons_per_layer</span> <span class=o>=</span> <span class=n>n_neurons_per_layer</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>=</span> <span class=n>activation</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>        <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>=</span> <span class=n>loss</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>optimizer</span> <span class=o>=</span> <span class=n>optimizer</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>epochs</span> <span class=o>=</span> <span class=n>epochs</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>eta</span> <span class=o>=</span> <span class=n>eta</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>        <span class=bp>self</span><span class=o>.</span><span class=n>weights</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>        <span class=bp>self</span><span class=o>.</span><span class=n>biases</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>        <span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span> <span class=o>=</span> <span class=p>[</span><span class=n>n_features</span><span class=p>]</span> <span class=o>+</span> <span class=n>n_neurons_per_layer</span> <span class=c1>#dimensões de cada camada, incluindo a de output</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>            <span class=n>w</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>*</span> <span class=mf>0.1</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>            <span class=n>b</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>],))</span>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>            <span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a>            <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== Inicialização de Pesos e Biases ==="</span><span class=p>)</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>)):</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Camada </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>:"</span><span class=p>)</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"W</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> shape </span><span class=si>{</span><span class=n>w</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>:</span><span class=se>\n</span><span class=si>{</span><span class=n>w</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"b</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> shape </span><span class=si>{</span><span class=n>b</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>:</span><span class=se>\n</span><span class=si>{</span><span class=n>b</span><span class=si>}</span><span class=se>\n</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1e-5</span><span class=p>,</span> <span class=n>window</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-8-35><a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>        <span class=n>loss_history</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-36><a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a>
</span><span id=__span-8-37><a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a>        <span class=k>for</span> <span class=n>epoch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>epochs</span><span class=p>):</span>
</span><span id=__span-8-38><a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a>            <span class=n>total_loss</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-8-39><a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
</span><span id=__span-8-40><a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>                <span class=n>y_pred</span><span class=p>,</span> <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward_pass</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-8-41><a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a>                <span class=n>loss</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss_calculation</span><span class=p>(</span><span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-42><a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a>                <span class=n>total_loss</span> <span class=o>+=</span> <span class=n>loss</span>
</span><span id=__span-8-43><a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a>                <span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>backpropagation</span><span class=p>(</span><span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>cache</span><span class=p>)</span>
</span><span id=__span-8-44><a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a>                <span class=bp>self</span><span class=o>.</span><span class=n>update_parameters</span><span class=p>(</span><span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span><span class=p>)</span>
</span><span id=__span-8-45><a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a>
</span><span id=__span-8-46><a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a>            <span class=n>avg_loss</span> <span class=o>=</span> <span class=n>total_loss</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span><span id=__span-8-47><a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a>            <span class=n>loss_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>avg_loss</span><span class=p>)</span>
</span><span id=__span-8-48><a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a>
</span><span id=__span-8-49><a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a>            <span class=k>if</span> <span class=n>epoch</span> <span class=o>%</span> <span class=mi>10</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-8-50><a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2>, Loss: </span><span class=si>{</span><span class=n>avg_loss</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-8-51><a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a>
</span><span id=__span-8-52><a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a>            <span class=c1># critério de parada: média móvel dos últimos "window" epochs</span>
</span><span id=__span-8-53><a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a>            <span class=k>if</span> <span class=n>epoch</span> <span class=o>&gt;=</span> <span class=n>window</span><span class=p>:</span>
</span><span id=__span-8-54><a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a>                <span class=n>moving_avg_prev</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>loss_history</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=o>*</span><span class=n>window</span><span class=p>:</span><span class=o>-</span><span class=n>window</span><span class=p>])</span> <span class=c1>#-20 até -10</span>
</span><span id=__span-8-55><a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a>                <span class=n>moving_avg_curr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>loss_history</span><span class=p>[</span><span class=o>-</span><span class=n>window</span><span class=p>:])</span> <span class=c1># -10 até atual</span>
</span><span id=__span-8-56><a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a>                <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>moving_avg_prev</span> <span class=o>-</span> <span class=n>moving_avg_curr</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>threshold</span><span class=p>:</span>
</span><span id=__span-8-57><a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Treinamento encerrado no epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2> (convergência detectada)."</span><span class=p>)</span>
</span><span id=__span-8-58><a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a>                    <span class=k>break</span>
</span><span id=__span-8-59><a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a>
</span><span id=__span-8-60><a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a>    <span class=k>def</span><span class=w> </span><span class=nf>test</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-61><a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a>        <span class=n>preds</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-62><a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>X</span><span class=p>)):</span> 
</span><span id=__span-8-63><a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a>            <span class=n>y_pred</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward_pass</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=c1>#utiliza pesos já definidos da mlp</span>
</span><span id=__span-8-64><a id=__codelineno-8-64 name=__codelineno-8-64 href=#__codelineno-8-64></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-8-65><a id=__codelineno-8-65 name=__codelineno-8-65 href=#__codelineno-8-65></a>                <span class=n>preds</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_pred</span><span class=p>))</span>  <span class=c1># multi-class, pega o maior do vetor</span>
</span><span id=__span-8-66><a id=__codelineno-8-66 name=__codelineno-8-66 href=#__codelineno-8-66></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-67><a id=__codelineno-8-67 name=__codelineno-8-67 href=#__codelineno-8-67></a>                <span class=n>preds</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>1</span> <span class=k>if</span> <span class=n>y_pred</span> <span class=o>&gt;</span> <span class=mf>0.5</span> <span class=k>else</span> <span class=mi>0</span><span class=p>)</span>  <span class=c1># binário</span>
</span><span id=__span-8-68><a id=__codelineno-8-68 name=__codelineno-8-68 href=#__codelineno-8-68></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>preds</span><span class=p>)</span>
</span><span id=__span-8-69><a id=__codelineno-8-69 name=__codelineno-8-69 href=#__codelineno-8-69></a>
</span><span id=__span-8-70><a id=__codelineno-8-70 name=__codelineno-8-70 href=#__codelineno-8-70></a>    <span class=k>def</span><span class=w> </span><span class=nf>evaluate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>plot_confusion</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span> <span class=n>plot_roc</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span> <span class=n>preds</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-8-71><a id=__codelineno-8-71 name=__codelineno-8-71 href=#__codelineno-8-71></a>        <span class=n>acc</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_accuracy</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>preds</span><span class=p>)</span>
</span><span id=__span-8-72><a id=__codelineno-8-72 name=__codelineno-8-72 href=#__codelineno-8-72></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Accuracy: </span><span class=si>{</span><span class=n>acc</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%"</span><span class=p>)</span>
</span><span id=__span-8-73><a id=__codelineno-8-73 name=__codelineno-8-73 href=#__codelineno-8-73></a>
</span><span id=__span-8-74><a id=__codelineno-8-74 name=__codelineno-8-74 href=#__codelineno-8-74></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== Pesos e Biases do Modelo ==="</span><span class=p>)</span>
</span><span id=__span-8-75><a id=__codelineno-8-75 name=__codelineno-8-75 href=#__codelineno-8-75></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>)):</span>
</span><span id=__span-8-76><a id=__codelineno-8-76 name=__codelineno-8-76 href=#__codelineno-8-76></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Camada </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>:"</span><span class=p>)</span>
</span><span id=__span-8-77><a id=__codelineno-8-77 name=__codelineno-8-77 href=#__codelineno-8-77></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Pesos W</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> (shape </span><span class=si>{</span><span class=n>w</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>):"</span><span class=p>)</span>
</span><span id=__span-8-78><a id=__codelineno-8-78 name=__codelineno-8-78 href=#__codelineno-8-78></a>            <span class=nb>print</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>
</span><span id=__span-8-79><a id=__codelineno-8-79 name=__codelineno-8-79 href=#__codelineno-8-79></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Biases b</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> (shape </span><span class=si>{</span><span class=n>b</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>):"</span><span class=p>)</span>
</span><span id=__span-8-80><a id=__codelineno-8-80 name=__codelineno-8-80 href=#__codelineno-8-80></a>            <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-8-81><a id=__codelineno-8-81 name=__codelineno-8-81 href=#__codelineno-8-81></a>
</span><span id=__span-8-82><a id=__codelineno-8-82 name=__codelineno-8-82 href=#__codelineno-8-82></a>        <span class=n>binary</span> <span class=o>=</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y</span><span class=p>))</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-83><a id=__codelineno-8-83 name=__codelineno-8-83 href=#__codelineno-8-83></a>
</span><span id=__span-8-84><a id=__codelineno-8-84 name=__codelineno-8-84 href=#__codelineno-8-84></a>        <span class=k>if</span> <span class=n>plot_confusion</span><span class=p>:</span>
</span><span id=__span-8-85><a id=__codelineno-8-85 name=__codelineno-8-85 href=#__codelineno-8-85></a>            <span class=n>cm</span> <span class=o>=</span> <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>preds</span><span class=p>)</span>
</span><span id=__span-8-86><a id=__codelineno-8-86 name=__codelineno-8-86 href=#__codelineno-8-86></a>            <span class=n>cm_norm</span> <span class=o>=</span> <span class=n>cm</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s2>"float"</span><span class=p>)</span> <span class=o>/</span> <span class=n>cm</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)[:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>  <span class=c1># normaliza por linha</span>
</span><span id=__span-8-87><a id=__codelineno-8-87 name=__codelineno-8-87 href=#__codelineno-8-87></a>
</span><span id=__span-8-88><a id=__codelineno-8-88 name=__codelineno-8-88 href=#__codelineno-8-88></a>            <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>5</span><span class=p>))</span>
</span><span id=__span-8-89><a id=__codelineno-8-89 name=__codelineno-8-89 href=#__codelineno-8-89></a>            <span class=n>sns</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span><span class=n>cm_norm</span><span class=p>,</span> <span class=n>annot</span><span class=o>=</span><span class=n>cm</span><span class=p>,</span> <span class=n>fmt</span><span class=o>=</span><span class=s2>"d"</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s2>"Blues"</span><span class=p>,</span> <span class=n>xticklabels</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y</span><span class=p>),</span> <span class=n>yticklabels</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y</span><span class=p>))</span>
</span><span id=__span-8-90><a id=__codelineno-8-90 name=__codelineno-8-90 href=#__codelineno-8-90></a>            <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>"Confusion Matrix (normalized by row)"</span><span class=p>)</span>
</span><span id=__span-8-91><a id=__codelineno-8-91 name=__codelineno-8-91 href=#__codelineno-8-91></a>            <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>"Predicted"</span><span class=p>)</span>
</span><span id=__span-8-92><a id=__codelineno-8-92 name=__codelineno-8-92 href=#__codelineno-8-92></a>            <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>"True"</span><span class=p>)</span>
</span><span id=__span-8-93><a id=__codelineno-8-93 name=__codelineno-8-93 href=#__codelineno-8-93></a>            <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-8-94><a id=__codelineno-8-94 name=__codelineno-8-94 href=#__codelineno-8-94></a>
</span><span id=__span-8-95><a id=__codelineno-8-95 name=__codelineno-8-95 href=#__codelineno-8-95></a>        <span class=c1># ROC curve (somente para binário)</span>
</span><span id=__span-8-96><a id=__codelineno-8-96 name=__codelineno-8-96 href=#__codelineno-8-96></a>        <span class=k>if</span> <span class=n>plot_roc</span> <span class=ow>and</span> <span class=n>binary</span><span class=p>:</span>
</span><span id=__span-8-97><a id=__codelineno-8-97 name=__codelineno-8-97 href=#__codelineno-8-97></a>            <span class=c1># coletar probabilidades em vez de labels</span>
</span><span id=__span-8-98><a id=__codelineno-8-98 name=__codelineno-8-98 href=#__codelineno-8-98></a>            <span class=n>y_scores</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-8-99><a id=__codelineno-8-99 name=__codelineno-8-99 href=#__codelineno-8-99></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>X</span><span class=p>)):</span>
</span><span id=__span-8-100><a id=__codelineno-8-100 name=__codelineno-8-100 href=#__codelineno-8-100></a>                <span class=n>y_pred</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward_pass</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-8-101><a id=__codelineno-8-101 name=__codelineno-8-101 href=#__codelineno-8-101></a>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-8-102><a id=__codelineno-8-102 name=__codelineno-8-102 href=#__codelineno-8-102></a>                    <span class=n>y_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y_pred</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># probabilidade da classe 1</span>
</span><span id=__span-8-103><a id=__codelineno-8-103 name=__codelineno-8-103 href=#__codelineno-8-103></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-104><a id=__codelineno-8-104 name=__codelineno-8-104 href=#__codelineno-8-104></a>                    <span class=n>y_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y_pred</span><span class=p>)</span>     <span class=c1># saída do sigmoid</span>
</span><span id=__span-8-105><a id=__codelineno-8-105 name=__codelineno-8-105 href=#__codelineno-8-105></a>            <span class=n>y_scores</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>y_scores</span><span class=p>)</span>
</span><span id=__span-8-106><a id=__codelineno-8-106 name=__codelineno-8-106 href=#__codelineno-8-106></a>
</span><span id=__span-8-107><a id=__codelineno-8-107 name=__codelineno-8-107 href=#__codelineno-8-107></a>            <span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>roc_curve</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>y_scores</span><span class=p>)</span>
</span><span id=__span-8-108><a id=__codelineno-8-108 name=__codelineno-8-108 href=#__codelineno-8-108></a>            <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>auc</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>)</span>
</span><span id=__span-8-109><a id=__codelineno-8-109 name=__codelineno-8-109 href=#__codelineno-8-109></a>
</span><span id=__span-8-110><a id=__codelineno-8-110 name=__codelineno-8-110 href=#__codelineno-8-110></a>            <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span><span id=__span-8-111><a id=__codelineno-8-111 name=__codelineno-8-111 href=#__codelineno-8-111></a>            <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>"darkorange"</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"ROC curve (area = </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>)"</span><span class=p>)</span>
</span><span id=__span-8-112><a id=__codelineno-8-112 name=__codelineno-8-112 href=#__codelineno-8-112></a>            <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s2>"navy"</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>"--"</span><span class=p>)</span>
</span><span id=__span-8-113><a id=__codelineno-8-113 name=__codelineno-8-113 href=#__codelineno-8-113></a>            <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>"False Positive Rate"</span><span class=p>)</span>
</span><span id=__span-8-114><a id=__codelineno-8-114 name=__codelineno-8-114 href=#__codelineno-8-114></a>            <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>"True Positive Rate"</span><span class=p>)</span>
</span><span id=__span-8-115><a id=__codelineno-8-115 name=__codelineno-8-115 href=#__codelineno-8-115></a>            <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>"Receiver Operating Characteristic (ROC)"</span><span class=p>)</span>
</span><span id=__span-8-116><a id=__codelineno-8-116 name=__codelineno-8-116 href=#__codelineno-8-116></a>            <span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s2>"lower right"</span><span class=p>)</span>
</span><span id=__span-8-117><a id=__codelineno-8-117 name=__codelineno-8-117 href=#__codelineno-8-117></a>            <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-8-118><a id=__codelineno-8-118 name=__codelineno-8-118 href=#__codelineno-8-118></a>
</span><span id=__span-8-119><a id=__codelineno-8-119 name=__codelineno-8-119 href=#__codelineno-8-119></a>    <span class=k>def</span><span class=w> </span><span class=nf>calculate_accuracy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-8-120><a id=__codelineno-8-120 name=__codelineno-8-120 href=#__codelineno-8-120></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>y_true</span> <span class=o>==</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-121><a id=__codelineno-8-121 name=__codelineno-8-121 href=#__codelineno-8-121></a>
</span><span id=__span-8-122><a id=__codelineno-8-122 name=__codelineno-8-122 href=#__codelineno-8-122></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward_pass</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>:</span>
</span><span id=__span-8-123><a id=__codelineno-8-123 name=__codelineno-8-123 href=#__codelineno-8-123></a>        <span class=n>a</span> <span class=o>=</span> <span class=n>x</span>
</span><span id=__span-8-124><a id=__codelineno-8-124 name=__codelineno-8-124 href=#__codelineno-8-124></a>        <span class=n>cache</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"z"</span><span class=p>:</span> <span class=p>[],</span> <span class=s2>"a"</span><span class=p>:</span> <span class=p>[</span><span class=n>a</span><span class=p>]}</span>  <span class=c1># salva ativações</span>
</span><span id=__span-8-125><a id=__codelineno-8-125 name=__codelineno-8-125 href=#__codelineno-8-125></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)):</span>
</span><span id=__span-8-126><a id=__codelineno-8-126 name=__codelineno-8-126 href=#__codelineno-8-126></a>            <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>a</span><span class=p>)</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-8-127><a id=__codelineno-8-127 name=__codelineno-8-127 href=#__codelineno-8-127></a>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-8-128><a id=__codelineno-8-128 name=__codelineno-8-128 href=#__codelineno-8-128></a>                <span class=n>a</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-129><a id=__codelineno-8-129 name=__codelineno-8-129 href=#__codelineno-8-129></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-130><a id=__codelineno-8-130 name=__codelineno-8-130 href=#__codelineno-8-130></a>                <span class=n>a</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation_function</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-131><a id=__codelineno-8-131 name=__codelineno-8-131 href=#__codelineno-8-131></a>            <span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-132><a id=__codelineno-8-132 name=__codelineno-8-132 href=#__codelineno-8-132></a>            <span class=n>cache</span><span class=p>[</span><span class=s2>"a"</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span><span id=__span-8-133><a id=__codelineno-8-133 name=__codelineno-8-133 href=#__codelineno-8-133></a>        <span class=k>return</span> <span class=n>a</span><span class=p>,</span> <span class=n>cache</span>
</span><span id=__span-8-134><a id=__codelineno-8-134 name=__codelineno-8-134 href=#__codelineno-8-134></a>
</span><span id=__span-8-135><a id=__codelineno-8-135 name=__codelineno-8-135 href=#__codelineno-8-135></a>    <span class=k>def</span><span class=w> </span><span class=nf>backpropagation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>cache</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>:</span>
</span><span id=__span-8-136><a id=__codelineno-8-136 name=__codelineno-8-136 href=#__codelineno-8-136></a>        <span class=n>grads_w</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)</span>
</span><span id=__span-8-137><a id=__codelineno-8-137 name=__codelineno-8-137 href=#__codelineno-8-137></a>        <span class=n>grads_b</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>)</span>
</span><span id=__span-8-138><a id=__codelineno-8-138 name=__codelineno-8-138 href=#__codelineno-8-138></a>
</span><span id=__span-8-139><a id=__codelineno-8-139 name=__codelineno-8-139 href=#__codelineno-8-139></a>        <span class=c1># Última camada</span>
</span><span id=__span-8-140><a id=__codelineno-8-140 name=__codelineno-8-140 href=#__codelineno-8-140></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-8-141><a id=__codelineno-8-141 name=__codelineno-8-141 href=#__codelineno-8-141></a>            <span class=n>delta</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_cross_entropy</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-142><a id=__codelineno-8-142 name=__codelineno-8-142 href=#__codelineno-8-142></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"mse"</span><span class=p>:</span>
</span><span id=__span-8-143><a id=__codelineno-8-143 name=__codelineno-8-143 href=#__codelineno-8-143></a>            <span class=n>dloss_dy_pred</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-144><a id=__codelineno-8-144 name=__codelineno-8-144 href=#__codelineno-8-144></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"sigmoid"</span><span class=p>:</span>
</span><span id=__span-8-145><a id=__codelineno-8-145 name=__codelineno-8-145 href=#__codelineno-8-145></a>                <span class=n>delta</span> <span class=o>=</span> <span class=n>dloss_dy_pred</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_sigmoid</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-8-146><a id=__codelineno-8-146 name=__codelineno-8-146 href=#__codelineno-8-146></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"tanh"</span><span class=p>:</span>
</span><span id=__span-8-147><a id=__codelineno-8-147 name=__codelineno-8-147 href=#__codelineno-8-147></a>                <span class=n>delta</span> <span class=o>=</span> <span class=n>dloss_dy_pred</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_tanh</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-8-148><a id=__codelineno-8-148 name=__codelineno-8-148 href=#__codelineno-8-148></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"relu"</span><span class=p>:</span>
</span><span id=__span-8-149><a id=__codelineno-8-149 name=__codelineno-8-149 href=#__codelineno-8-149></a>                <span class=n>delta</span> <span class=o>=</span> <span class=n>dloss_dy_pred</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_relu</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-8-150><a id=__codelineno-8-150 name=__codelineno-8-150 href=#__codelineno-8-150></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-151><a id=__codelineno-8-151 name=__codelineno-8-151 href=#__codelineno-8-151></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"Loss não suportada"</span><span class=p>)</span>
</span><span id=__span-8-152><a id=__codelineno-8-152 name=__codelineno-8-152 href=#__codelineno-8-152></a>
</span><span id=__span-8-153><a id=__codelineno-8-153 name=__codelineno-8-153 href=#__codelineno-8-153></a>        <span class=n>grads_w</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>delta</span><span class=p>,</span> <span class=n>cache</span><span class=p>[</span><span class=s2>"a"</span><span class=p>][</span><span class=o>-</span><span class=mi>2</span><span class=p>])</span>
</span><span id=__span-8-154><a id=__codelineno-8-154 name=__codelineno-8-154 href=#__codelineno-8-154></a>        <span class=n>grads_b</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>delta</span>
</span><span id=__span-8-155><a id=__codelineno-8-155 name=__codelineno-8-155 href=#__codelineno-8-155></a>
</span><span id=__span-8-156><a id=__codelineno-8-156 name=__codelineno-8-156 href=#__codelineno-8-156></a>        <span class=c1># Camadas ocultas</span>
</span><span id=__span-8-157><a id=__codelineno-8-157 name=__codelineno-8-157 href=#__codelineno-8-157></a>        <span class=k>for</span> <span class=n>l</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)):</span>
</span><span id=__span-8-158><a id=__codelineno-8-158 name=__codelineno-8-158 href=#__codelineno-8-158></a>            <span class=n>delta</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>[</span><span class=n>l</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>delta</span><span class=p>)</span>
</span><span id=__span-8-159><a id=__codelineno-8-159 name=__codelineno-8-159 href=#__codelineno-8-159></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"sigmoid"</span><span class=p>:</span>
</span><span id=__span-8-160><a id=__codelineno-8-160 name=__codelineno-8-160 href=#__codelineno-8-160></a>                <span class=n>delta</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_sigmoid</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-8-161><a id=__codelineno-8-161 name=__codelineno-8-161 href=#__codelineno-8-161></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"tanh"</span><span class=p>:</span>
</span><span id=__span-8-162><a id=__codelineno-8-162 name=__codelineno-8-162 href=#__codelineno-8-162></a>                <span class=n>delta</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_tanh</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-8-163><a id=__codelineno-8-163 name=__codelineno-8-163 href=#__codelineno-8-163></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"relu"</span><span class=p>:</span>
</span><span id=__span-8-164><a id=__codelineno-8-164 name=__codelineno-8-164 href=#__codelineno-8-164></a>                <span class=n>delta</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_relu</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-8-165><a id=__codelineno-8-165 name=__codelineno-8-165 href=#__codelineno-8-165></a>            <span class=n>grads_w</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>delta</span><span class=p>,</span> <span class=n>cache</span><span class=p>[</span><span class=s2>"a"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-8-166><a id=__codelineno-8-166 name=__codelineno-8-166 href=#__codelineno-8-166></a>            <span class=n>grads_b</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>delta</span>
</span><span id=__span-8-167><a id=__codelineno-8-167 name=__codelineno-8-167 href=#__codelineno-8-167></a>
</span><span id=__span-8-168><a id=__codelineno-8-168 name=__codelineno-8-168 href=#__codelineno-8-168></a>        <span class=k>return</span> <span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span>
</span><span id=__span-8-169><a id=__codelineno-8-169 name=__codelineno-8-169 href=#__codelineno-8-169></a>
</span><span id=__span-8-170><a id=__codelineno-8-170 name=__codelineno-8-170 href=#__codelineno-8-170></a>    <span class=k>def</span><span class=w> </span><span class=nf>update_parameters</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span><span class=p>):</span>
</span><span id=__span-8-171><a id=__codelineno-8-171 name=__codelineno-8-171 href=#__codelineno-8-171></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>optimizer</span> <span class=o>==</span> <span class=s2>"gd"</span><span class=p>:</span>  <span class=c1># Gradient Descent padrão</span>
</span><span id=__span-8-172><a id=__codelineno-8-172 name=__codelineno-8-172 href=#__codelineno-8-172></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)):</span>
</span><span id=__span-8-173><a id=__codelineno-8-173 name=__codelineno-8-173 href=#__codelineno-8-173></a>                <span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>eta</span> <span class=o>*</span> <span class=n>grads_w</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-8-174><a id=__codelineno-8-174 name=__codelineno-8-174 href=#__codelineno-8-174></a>                <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>  <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>eta</span> <span class=o>*</span> <span class=n>grads_b</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-8-175><a id=__codelineno-8-175 name=__codelineno-8-175 href=#__codelineno-8-175></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-176><a id=__codelineno-8-176 name=__codelineno-8-176 href=#__codelineno-8-176></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Optimizer </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>optimizer</span><span class=si>}</span><span class=s2> não suportado"</span><span class=p>)</span>
</span><span id=__span-8-177><a id=__codelineno-8-177 name=__codelineno-8-177 href=#__codelineno-8-177></a>
</span><span id=__span-8-178><a id=__codelineno-8-178 name=__codelineno-8-178 href=#__codelineno-8-178></a>    <span class=k>def</span><span class=w> </span><span class=nf>loss_calculation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-8-179><a id=__codelineno-8-179 name=__codelineno-8-179 href=#__codelineno-8-179></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s1>'mse'</span><span class=p>:</span>
</span><span id=__span-8-180><a id=__codelineno-8-180 name=__codelineno-8-180 href=#__codelineno-8-180></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-181><a id=__codelineno-8-181 name=__codelineno-8-181 href=#__codelineno-8-181></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s1>'cross_entropy'</span><span class=p>:</span>
</span><span id=__span-8-182><a id=__codelineno-8-182 name=__codelineno-8-182 href=#__codelineno-8-182></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cross_entropy</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-183><a id=__codelineno-8-183 name=__codelineno-8-183 href=#__codelineno-8-183></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-184><a id=__codelineno-8-184 name=__codelineno-8-184 href=#__codelineno-8-184></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Função de loss </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>loss</span><span class=si>}</span><span class=s2> não suportada"</span><span class=p>)</span>
</span><span id=__span-8-185><a id=__codelineno-8-185 name=__codelineno-8-185 href=#__codelineno-8-185></a>
</span><span id=__span-8-186><a id=__codelineno-8-186 name=__codelineno-8-186 href=#__codelineno-8-186></a>    <span class=k>def</span><span class=w> </span><span class=nf>activation_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-187><a id=__codelineno-8-187 name=__codelineno-8-187 href=#__codelineno-8-187></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s1>'sigmoid'</span><span class=p>:</span>
</span><span id=__span-8-188><a id=__codelineno-8-188 name=__codelineno-8-188 href=#__codelineno-8-188></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>sigmoid</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-189><a id=__codelineno-8-189 name=__codelineno-8-189 href=#__codelineno-8-189></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s1>'tanh'</span><span class=p>:</span>
</span><span id=__span-8-190><a id=__codelineno-8-190 name=__codelineno-8-190 href=#__codelineno-8-190></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-191><a id=__codelineno-8-191 name=__codelineno-8-191 href=#__codelineno-8-191></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s1>'relu'</span><span class=p>:</span>
</span><span id=__span-8-192><a id=__codelineno-8-192 name=__codelineno-8-192 href=#__codelineno-8-192></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-193><a id=__codelineno-8-193 name=__codelineno-8-193 href=#__codelineno-8-193></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-8-194><a id=__codelineno-8-194 name=__codelineno-8-194 href=#__codelineno-8-194></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Função de ativação </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>activation</span><span class=si>}</span><span class=s2> não suportada"</span><span class=p>)</span>
</span><span id=__span-8-195><a id=__codelineno-8-195 name=__codelineno-8-195 href=#__codelineno-8-195></a>
</span><span id=__span-8-196><a id=__codelineno-8-196 name=__codelineno-8-196 href=#__codelineno-8-196></a>    <span class=k>def</span><span class=w> </span><span class=nf>mse</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-8-197><a id=__codelineno-8-197 name=__codelineno-8-197 href=#__codelineno-8-197></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>((</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_pred</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-8-198><a id=__codelineno-8-198 name=__codelineno-8-198 href=#__codelineno-8-198></a>
</span><span id=__span-8-199><a id=__codelineno-8-199 name=__codelineno-8-199 href=#__codelineno-8-199></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_mse</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-8-200><a id=__codelineno-8-200 name=__codelineno-8-200 href=#__codelineno-8-200></a>        <span class=k>return</span> <span class=o>-</span><span class=mi>2</span><span class=o>*</span><span class=p>(</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-201><a id=__codelineno-8-201 name=__codelineno-8-201 href=#__codelineno-8-201></a>
</span><span id=__span-8-202><a id=__codelineno-8-202 name=__codelineno-8-202 href=#__codelineno-8-202></a>    <span class=k>def</span><span class=w> </span><span class=nf>cross_entropy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-8-203><a id=__codelineno-8-203 name=__codelineno-8-203 href=#__codelineno-8-203></a>        <span class=n>num_classes</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-204><a id=__codelineno-8-204 name=__codelineno-8-204 href=#__codelineno-8-204></a>        <span class=n>y_true_onehot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=n>num_classes</span><span class=p>)[</span><span class=n>y_true</span><span class=p>]</span>
</span><span id=__span-8-205><a id=__codelineno-8-205 name=__codelineno-8-205 href=#__codelineno-8-205></a>        <span class=n>eps</span> <span class=o>=</span> <span class=mf>1e-15</span>
</span><span id=__span-8-206><a id=__codelineno-8-206 name=__codelineno-8-206 href=#__codelineno-8-206></a>        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>y_pred</span><span class=p>,</span> <span class=n>eps</span><span class=p>,</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>eps</span><span class=p>)</span>
</span><span id=__span-8-207><a id=__codelineno-8-207 name=__codelineno-8-207 href=#__codelineno-8-207></a>        <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>y_true_onehot</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-8-208><a id=__codelineno-8-208 name=__codelineno-8-208 href=#__codelineno-8-208></a>
</span><span id=__span-8-209><a id=__codelineno-8-209 name=__codelineno-8-209 href=#__codelineno-8-209></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_cross_entropy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-210><a id=__codelineno-8-210 name=__codelineno-8-210 href=#__codelineno-8-210></a>        <span class=n>num_classes</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-8-211><a id=__codelineno-8-211 name=__codelineno-8-211 href=#__codelineno-8-211></a>        <span class=n>y_true_onehot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=n>num_classes</span><span class=p>)[</span><span class=n>y_true</span><span class=p>]</span>
</span><span id=__span-8-212><a id=__codelineno-8-212 name=__codelineno-8-212 href=#__codelineno-8-212></a>        <span class=k>return</span> <span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_true_onehot</span>
</span><span id=__span-8-213><a id=__codelineno-8-213 name=__codelineno-8-213 href=#__codelineno-8-213></a>
</span><span id=__span-8-214><a id=__codelineno-8-214 name=__codelineno-8-214 href=#__codelineno-8-214></a>    <span class=k>def</span><span class=w> </span><span class=nf>sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-215><a id=__codelineno-8-215 name=__codelineno-8-215 href=#__codelineno-8-215></a>        <span class=k>return</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>z</span><span class=p>))</span>
</span><span id=__span-8-216><a id=__codelineno-8-216 name=__codelineno-8-216 href=#__codelineno-8-216></a>
</span><span id=__span-8-217><a id=__codelineno-8-217 name=__codelineno-8-217 href=#__codelineno-8-217></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-218><a id=__codelineno-8-218 name=__codelineno-8-218 href=#__codelineno-8-218></a>        <span class=n>s</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>sigmoid</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-219><a id=__codelineno-8-219 name=__codelineno-8-219 href=#__codelineno-8-219></a>        <span class=k>return</span> <span class=n>s</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>s</span><span class=p>)</span>
</span><span id=__span-8-220><a id=__codelineno-8-220 name=__codelineno-8-220 href=#__codelineno-8-220></a>
</span><span id=__span-8-221><a id=__codelineno-8-221 name=__codelineno-8-221 href=#__codelineno-8-221></a>    <span class=k>def</span><span class=w> </span><span class=nf>tanh</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-222><a id=__codelineno-8-222 name=__codelineno-8-222 href=#__codelineno-8-222></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-223><a id=__codelineno-8-223 name=__codelineno-8-223 href=#__codelineno-8-223></a>
</span><span id=__span-8-224><a id=__codelineno-8-224 name=__codelineno-8-224 href=#__codelineno-8-224></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_tanh</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-225><a id=__codelineno-8-225 name=__codelineno-8-225 href=#__codelineno-8-225></a>        <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>))</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-8-226><a id=__codelineno-8-226 name=__codelineno-8-226 href=#__codelineno-8-226></a>
</span><span id=__span-8-227><a id=__codelineno-8-227 name=__codelineno-8-227 href=#__codelineno-8-227></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-228><a id=__codelineno-8-228 name=__codelineno-8-228 href=#__codelineno-8-228></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>)</span>
</span><span id=__span-8-229><a id=__codelineno-8-229 name=__codelineno-8-229 href=#__codelineno-8-229></a>
</span><span id=__span-8-230><a id=__codelineno-8-230 name=__codelineno-8-230 href=#__codelineno-8-230></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_relu</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-231><a id=__codelineno-8-231 name=__codelineno-8-231 href=#__codelineno-8-231></a>        <span class=k>return</span> <span class=p>(</span><span class=n>z</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>
</span><span id=__span-8-232><a id=__codelineno-8-232 name=__codelineno-8-232 href=#__codelineno-8-232></a>
</span><span id=__span-8-233><a id=__codelineno-8-233 name=__codelineno-8-233 href=#__codelineno-8-233></a>    <span class=k>def</span><span class=w> </span><span class=nf>softmax</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-8-234><a id=__codelineno-8-234 name=__codelineno-8-234 href=#__codelineno-8-234></a>        <span class=n>exp_z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>z</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>z</span><span class=p>))</span>
</span><span id=__span-8-235><a id=__codelineno-8-235 name=__codelineno-8-235 href=#__codelineno-8-235></a>        <span class=k>return</span> <span class=n>exp_z</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>exp_z</span><span class=p>)</span>
</span></code></pre></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 6, 2025 02:35:14 UTC">October 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 6, 2025 02:35:14 UTC">October 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:felipebns@al.insper.edu.br>felipebns</a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking", "navigation.expand"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=https://unpkg.com/mathjax/es5/tex-mml-chtml.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js></script> <script src=https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js></script> <script src=../../assets/javascripts/badge.js async></script> <script src=../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>