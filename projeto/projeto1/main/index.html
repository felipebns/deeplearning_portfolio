<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Felipe, B."><link href=https://felipebns.github.io/deeplearning_portfolio/projeto/projeto1/main/ rel=canonical><link href=../../../exercicio4/main/ rel=prev><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.21"><title>Projeto 1 - Portfolio de Felipe B</title><link rel=stylesheet href=../../../assets/stylesheets/main.2a3383ac.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.0.1%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../../assets/_markdown_exec_ansi.css><link rel=stylesheet href=../../../assets/stylesheets/badge.css><link rel=stylesheet href=../../../termynal.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#classificacao-satisfacao-de-passageiro-em-linhas-aereas class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Portfolio de Felipe B" class="md-header__button md-logo" aria-label="Portfolio de Felipe B" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Portfolio de Felipe B </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Projeto 1 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/felipebns/deeplearning_portfolio title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/documentation.template </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Portfolio de Felipe B" class="md-nav__button md-logo" aria-label="Portfolio de Felipe B" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> Portfolio de Felipe B </label> <div class=md-nav__source> <a href=https://github.com/felipebns/deeplearning_portfolio title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> github/documentation.template </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Exercicios </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Exercicios </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../exercicio1/main/ class=md-nav__link> <span class=md-ellipsis> Exercicio 1 </span> </a> </li> <li class=md-nav__item> <a href=../../../exercicio2/main/ class=md-nav__link> <span class=md-ellipsis> Exercicio 2 </span> </a> </li> <li class=md-nav__item> <a href=../../../exercicio3/main/ class=md-nav__link> <span class=md-ellipsis> Exercicio 3 </span> </a> </li> <li class=md-nav__item> <a href=../../../exercicio4/main/ class=md-nav__link> <span class=md-ellipsis> Exercicio 4 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Projeto </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Projeto </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Projeto 1 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Projeto 1 </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#autores class=md-nav__link> <span class=md-ellipsis> Autores </span> </a> <nav class=md-nav aria-label=Autores> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nota class=md-nav__link> <span class=md-ellipsis> Nota: </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#autores class=md-nav__link> <span class=md-ellipsis> Autores </span> </a> <nav class=md-nav aria-label=Autores> <ul class=md-nav__list> <li class=md-nav__item> <a href=#nota class=md-nav__link> <span class=md-ellipsis> Nota: </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=classificacao-satisfacao-de-passageiro-em-linhas-aereas>Classificação - Satisfação de Passageiro em Linhas Aéreas</h1> <h2 id=autores>Autores</h2> <ul> <li>Felipe Bakowski Nantes de Souza </li> <li>Vinicius Grecco Fonseca Mulato </li> <li>Victor Soares</li> </ul> <h3 id=nota>Nota:</h3> <ul> <li>O cógido foi feito considerando um arquivo auxiliar mlp.py e um outro utils.py. Aquele possui a implementação completa da mlp e este funções auxiliares que ajudam na organização</li> </ul> <h1 id=1-data-set-selecao>1. Data set - Seleção</h1> <h2 id=data-set-escolhido-analise-de-satisfacao-de-passageiros-em-voos-kaggle>Data set escolhido: Análise de satisfação de passageiros em voos, Kaggle</h2> <p>Esse data set devido a uma soma de alguns fatores. De início, ele representa um desafio real que muitas empresas precisam resolver e é interessante interagir com um problema que tenham reflexões reais. Ainda, ele possui grande número de linhas, proporcionando uma análise mais robusta, muitas features de todos os tipos e uma variável target bem balanceada. Criando assim, um terreno fértil para a análise de dados.</p> <ul> <li>Fonte: https://www.kaggle.com/datasets/teejmahal20/airline-passenger-satisfaction</li> </ul> <h1 id=2-data-set-explicacao>2. Data set - Explicação</h1> <p>Esse data set possui 25 colunas, 24 sendo potenciais features e 1 target (satisfação). Ela é uma variável categórica não ordenada e assume 2 valores: satisfeito ou neutro/insatisfeito. Ainda, a target está bem balanceada, estando divida em 43/57 %</p> <p>Em relação as features, elas variam entre qualitativas e quantitativas, sendo majoritariamente qualitativas e com poucas linhas com valores faltando.</p> <h3 id=colunas>Colunas</h3> <p>Agora, pode-se observar um código que concatena as bases de treino e teste, visualiza o número de linhas totais e cita todas as colunas que possuem no dataframe</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=kn>from</span><span class=w> </span><span class=nn>mlp</span><span class=w> </span><span class=kn>import</span> <span class=n>mlp</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>MinMaxScaler</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=kn>from</span><span class=w> </span><span class=nn>utils</span><span class=w> </span><span class=kn>import</span> <span class=n>plot_distributions</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=c1># carregar os dois conjuntos</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>df_train</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>"train.csv"</span><span class=p>)</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=n>df_test</span>  <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>"test.csv"</span><span class=p>)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=c1># marcar a origem para poder separar depois</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=n>df_train</span><span class=p>[</span><span class=s2>"_source"</span><span class=p>]</span> <span class=o>=</span> <span class=s2>"train"</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=n>df_test</span><span class=p>[</span><span class=s2>"_source"</span><span class=p>]</span>  <span class=o>=</span> <span class=s2>"test"</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=c1># concatenar</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>df_train</span><span class=p>,</span> <span class=n>df_test</span><span class=p>],</span> <span class=n>ignore_index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Shape combinado:"</span><span class=p>,</span> <span class=n>df</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s2>"_source"</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>())</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=n>target</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'satisfaction'</span><span class=p>]</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=n>df</span><span class=o>.</span><span class=n>columns</span>
</span></code></pre></div> <h3 id=output>Output</h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Shape combinado: (129880, 26)
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>_source
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>train    103904
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>test      25976
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>Name: count, dtype: int64
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>Index(['Unnamed: 0', 'id', 'Gender', 'Customer Type', 'Age', 'Type of Travel',
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>       'Class', 'Flight Distance', 'Inflight wifi service',
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>       'Departure/Arrival time convenient', 'Ease of Online booking',
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>       'Gate location', 'Food and drink', 'Online boarding', 'Seat comfort',
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>       'Inflight entertainment', 'On-board service', 'Leg room service',
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>       'Baggage handling', 'Checkin service', 'Inflight service',
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>       'Cleanliness', 'Departure Delay in Minutes', 'Arrival Delay in Minutes',
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>       'satisfaction', '_source'],
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>      dtype='object')
</span></code></pre></div> <h3 id=visualizando-equilibrio-na-variavel-target-satisfaction>Visualizando equilíbrio na variável Target (satisfaction)</h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>ax</span> <span class=o>=</span> <span class=n>sns</span><span class=o>.</span><span class=n>histplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>target</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s2>"percent"</span><span class=p>,</span> <span class=n>discrete</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>"Distribuição da variável 'satisfaction' (%)"</span><span class=p>)</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>"Satisfação"</span><span class=p>)</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>"Porcentagem"</span><span class=p>)</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../equilibrio.jpeg data-desc-position=bottom><img alt=equilibrio src=../equilibrio.jpeg></a></p> <h3 id=preenchendo-valores-vazios>Preenchendo valores vazios</h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>[</span><span class=n>df</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>any</span><span class=p>()])</span> <span class=c1>#observa-se colunas com valores faltando!</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Index(['Arrival Delay in Minutes'], dtype='object')
</span></code></pre></div> <h3 id=a-variavel-arrival-delay-e-numerica-para-tratar-os-valores-ausentes-nessa-coluna-o-grupo-considerou-que-a-ausencia-de-registros-poderia-estar-relacionada-a-um-esquecimento-por-parte-da-tripulacao-ou-da-companhia-aerea-ao-preencher-o-dado-possivelmente-por-nao-ter-havido-atraso-caso-um-atraso-tivesse-ocorrido-o-preenchimento-dessa-informacao-seria-mais-relevante-e-portanto-menos-provavel-de-ser-omitido-assim-optou-se-por-substituir-os-valores-ausentes-por-zero-que-alem-de-representar-a-ausencia-de-atraso-corresponde-tambem-a-moda-da-variavel>A variável Arrival Delay é numérica. Para tratar os valores ausentes nessa coluna, o grupo considerou que a ausência de registros poderia estar relacionada a um esquecimento por parte da tripulação ou da companhia aérea ao preencher o dado, possivelmente por não ter havido atraso. Caso um atraso tivesse ocorrido, o preenchimento dessa informação seria mais relevante e, portanto, menos provável de ser omitido. Assim, optou-se por substituir os valores ausentes por zero, que, além de representar a ausência de atraso, corresponde também à moda da variável.</h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>df</span><span class=p>[</span><span class=s1>'Arrival Delay in Minutes'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'Arrival Delay in Minutes'</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Arrival Delay in Minutes'</span><span class=p>]</span><span class=o>.</span><span class=n>mode</span><span class=p>()[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>[</span><span class=n>df</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>any</span><span class=p>()])</span> <span class=c1>#roda mais uma vez para garantir</span>
</span></code></pre></div> <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>Index([], dtype='object')
</span></code></pre></div> <h3 id=visualizacao-features>Visualização features</h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># definir colunas</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=n>quantitative_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s2>"Age"</span><span class=p>,</span> <span class=s2>"Flight Distance"</span><span class=p>,</span> <span class=s2>"Departure Delay in Minutes"</span><span class=p>,</span> <span class=s2>"Arrival Delay in Minutes"</span><span class=p>]</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=n>ordinal_cols</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=s2>"Inflight wifi service"</span><span class=p>,</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=s2>"Departure/Arrival time convenient"</span><span class=p>,</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    <span class=s2>"Ease of Online booking"</span><span class=p>,</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=s2>"Gate location"</span><span class=p>,</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=s2>"Food and drink"</span><span class=p>,</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>    <span class=s2>"Online boarding"</span><span class=p>,</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>    <span class=s2>"Seat comfort"</span><span class=p>,</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>    <span class=s2>"Inflight entertainment"</span><span class=p>,</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>    <span class=s2>"On-board service"</span><span class=p>,</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>    <span class=s2>"Leg room service"</span><span class=p>,</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>    <span class=s2>"Baggage handling"</span><span class=p>,</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>    <span class=s2>"Checkin service"</span><span class=p>,</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>    <span class=s2>"Inflight service"</span><span class=p>,</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>    <span class=s2>"Cleanliness"</span><span class=p>,</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=p>]</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=n>nominal_cols</span> <span class=o>=</span> <span class=p>[</span><span class=s2>"Gender"</span><span class=p>,</span> <span class=s2>"Customer Type"</span><span class=p>,</span> <span class=s2>"Type of Travel"</span><span class=p>,</span> <span class=s2>"Class"</span><span class=p>]</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=n>target_col</span> <span class=o>=</span> <span class=s2>"satisfaction"</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=c1># -------- PLOT ORIGINAL --------</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=n>plot_distributions</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>quantitative_cols</span><span class=p>,</span> <span class=n>ordinal_cols</span><span class=p>,</span> <span class=n>nominal_cols</span><span class=p>,</span> <span class=n>title_suffix</span><span class=o>=</span><span class=s2>"(Original)"</span><span class=p>,</span> <span class=n>force_ordinal_continuous</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../quant_semnorm.jpeg data-desc-position=bottom><img alt=quant_semnorm src=../quant_semnorm.jpeg></a> <a class=glightbox data-type=image data-width=auto data-height=auto href=../ord_semnorm.jpeg data-desc-position=bottom><img alt=ord_semnorm src=../ord_semnorm.jpeg></a> <a class=glightbox data-type=image data-width=auto data-height=auto href=../nominais_semnorm.jpeg data-desc-position=bottom><img alt=nominais_semnorm src=../nominais_semnorm.jpeg></a></p> <p>Pelas distribuições apresentadas, as variáveis categóricas estão relativamente balanceadas em alguns aspectos, mas apresentam diferenças relevantes em outros. O gênero está equilibrado entre homens e mulheres. Já o tipo de cliente é bastante desbalanceado, com predominância de clientes leais. No tipo de viagem, há mais viagens de negócios do que pessoais. Em relação à classe, as categorias Business e Eco têm proporções próximas, enquanto Eco Plus aparece em bem menor quantidade. A variável de satisfação também é relativamente balanceada, com uma leve maioria de clientes insatisfeitos ou neutros.</p> <p>Nas variáveis numéricas, observa-se diversidade: a idade segue uma distribuição concentrada entre 20 e 50 anos; a distância do voo é enviesada para valores menores; e os atrasos de partida e chegada apresentam forte concentração em atrasos curtos, com alguns outliers de longos atrasos. Já os serviços avaliativos (como wifi, comida, embarque, conforto de assento, limpeza, etc.) mostram distribuições variadas, mas tendem a concentrar respostas em notas intermediárias a altas, o que sugere certo viés positivo nas avaliações.</p> <h1 id=3-limpeza-de-dados-e-normalizacao>3. Limpeza de dados e normalização</h1> <h3 id=z-score-media-0-desvio-1>Z-Score (média 0, desvio 1)</h3> <p>Usamos em <strong>Age</strong> e nas variáveis <strong>ordinais (avaliações de 1 a 5)</strong>.</p> <ul> <li> <p><strong>Por quê?</strong></p> </li> <li> <p>O Z-score centraliza os dados na média e escala pela variabilidade.</p> </li> <li>Isso coloca todas essas variáveis em uma escala comparável (valores entre -2 e 2, geralmente).</li> <li>É útil quando os dados são aproximadamente simétricos ou queremos destacar desvios em relação à média.</li> </ul> <p>Exemplo: Idades diferentes são comparadas em termos de "quantos desvios padrão acima ou abaixo da média" estão.</p> <h3 id=min-max-1-1>Min-Max [-1, 1]</h3> <p>Usamos em <strong>Flight Distance</strong> e nos <strong>delays (após log)</strong>.</p> <ul> <li> <p><strong>Por quê?</strong></p> </li> <li> <p>O Min-Max traz os valores para um intervalo fixo, aqui entre -1 e 1.</p> </li> <li>Isso garante que nenhuma variável tenha escala muito maior que as outras.</li> <li>É útil quando a distribuição não é centrada na média, mas queremos que o modelo “veja” tudo na mesma faixa.</li> </ul> <h3 id=log-min-max>Log + Min-Max</h3> <p>Usamos em <strong>Departure Delay</strong> e <strong>Arrival Delay</strong>.</p> <ul> <li> <p><strong>Por quê?</strong></p> </li> <li> <p>Atrasos têm distribuição muito enviesada: muitos voos com atraso 0 ou baixo, e poucos voos com atrasos enormes.</p> </li> <li>O log “comprime” esses valores grandes, reduzindo o impacto dos extremos.</li> <li>Depois, aplicamos Min-Max para trazer o resultado para a faixa [-1,1], alinhando com as outras features.</li> </ul> <h3 id=one-hot-encoding-nominais>One-Hot Encoding (nominais)</h3> <p>Nas variáveis como <strong>Gender, Customer Type, Type of Travel, Class</strong>.</p> <ul> <li> <p><strong>Por quê?</strong></p> </li> <li> <p>São categorias sem ordem (ex.: “Male” ≠ maior que “Female”).</p> </li> <li>O One-Hot cria colunas binárias (<code>0</code> ou <code>1</code>) para cada categoria, sem necessidade de normalização extra.</li> </ul> <h2 id=implementando-a-normalizacao>Implementando a normalização</h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># -------- ONE-HOT + TARGET --------</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=n>df_encoded</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=n>nominal_cols</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=n>df_encoded</span><span class=p>[</span><span class=n>target_col</span><span class=p>]</span> <span class=o>=</span> <span class=n>df_encoded</span><span class=p>[</span><span class=n>target_col</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>({</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    <span class=s2>"satisfied"</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    <span class=s2>"neutral or dissatisfied"</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=p>})</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=c1># -------- NORMALIZAÇÃO --------</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=n>df_norm</span> <span class=o>=</span> <span class=n>df_encoded</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=c1># Age + ordinais -&gt; Z-score</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=n>scaler_z</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=n>df_norm</span><span class=p>[[</span><span class=s2>"Age"</span><span class=p>]</span> <span class=o>+</span> <span class=n>ordinal_cols</span><span class=p>]</span> <span class=o>=</span> <span class=n>scaler_z</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df_norm</span><span class=p>[[</span><span class=s2>"Age"</span><span class=p>]</span> <span class=o>+</span> <span class=n>ordinal_cols</span><span class=p>])</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=c1># Flight Distance -&gt; MinMax [-1,1]</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=n>scaler_fd</span> <span class=o>=</span> <span class=n>MinMaxScaler</span><span class=p>(</span><span class=n>feature_range</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>))</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=n>df_norm</span><span class=p>[</span><span class=s2>"Flight Distance"</span><span class=p>]</span> <span class=o>=</span> <span class=n>scaler_fd</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df_norm</span><span class=p>[[</span><span class=s2>"Flight Distance"</span><span class=p>]])</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=c1># Delays -&gt; log + MinMax [-1,1]</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>"Departure Delay in Minutes"</span><span class=p>,</span> <span class=s2>"Arrival Delay in Minutes"</span><span class=p>]:</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>    <span class=n>df_norm</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>log1p</span><span class=p>(</span><span class=n>df_norm</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>lower</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>    <span class=n>scaler_delay</span> <span class=o>=</span> <span class=n>MinMaxScaler</span><span class=p>(</span><span class=n>feature_range</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>))</span>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>    <span class=n>df_norm</span><span class=p>[</span><span class=n>col</span><span class=p>]</span> <span class=o>=</span> <span class=n>scaler_delay</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df_norm</span><span class=p>[[</span><span class=n>col</span><span class=p>]])</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>
</span><span id=__span-8-25><a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=n>df_norm</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span><span id=__span-8-26><a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=c1># -------- PLOT NORMALIZADO --------</span>
</span><span id=__span-8-27><a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=n>plot_distributions</span><span class=p>(</span>
</span><span id=__span-8-28><a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>    <span class=n>df_norm</span><span class=p>,</span>
</span><span id=__span-8-29><a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>    <span class=n>quantitative_cols</span><span class=p>,</span>
</span><span id=__span-8-30><a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>    <span class=n>ordinal_cols</span><span class=p>,</span>
</span><span id=__span-8-31><a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a>    <span class=p>[],</span>  <span class=c1># &lt;- passa lista vazia, não plota nominais</span>
</span><span id=__span-8-32><a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a>    <span class=n>title_suffix</span><span class=o>=</span><span class=s2>"(Normalizado)"</span><span class=p>,</span>
</span><span id=__span-8-33><a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a>    <span class=n>force_ordinal_continuous</span><span class=o>=</span><span class=kc>True</span>
</span><span id=__span-8-34><a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=p>)</span>
</span></code></pre></div> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../quant_comnorm.jpeg data-desc-position=bottom><img alt=quant_comnorm src=../quant_comnorm.jpeg></a> <a class=glightbox data-type=image data-width=auto data-height=auto href=../ord_comnorm.jpeg data-desc-position=bottom><img alt=ord_comnorm src=../ord_comnorm.jpeg></a></p> <h1 id=4-implementacao-mlp>4. Implementação MLP</h1> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>confusion_matrix</span><span class=p>,</span> <span class=n>roc_curve</span><span class=p>,</span> <span class=n>auc</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=k>class</span><span class=w> </span><span class=nc>mlp</span><span class=p>:</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>n_features</span><span class=p>:</span><span class=nb>int</span><span class=p>,</span> <span class=n>n_hidden_layers</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>n_neurons_per_layer</span><span class=p>:</span> <span class=nb>list</span><span class=p>,</span> 
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>                <span class=n>activation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>loss</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>optimizer</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>epochs</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>eta</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_features</span> <span class=o>=</span> <span class=n>n_features</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_hidden_layers</span> <span class=o>=</span> <span class=n>n_hidden_layers</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>        <span class=bp>self</span><span class=o>.</span><span class=n>n_neurons_per_layer</span> <span class=o>=</span> <span class=n>n_neurons_per_layer</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>        <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>=</span> <span class=n>activation</span>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>        <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>=</span> <span class=n>loss</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>optimizer</span> <span class=o>=</span> <span class=n>optimizer</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>epochs</span> <span class=o>=</span> <span class=n>epochs</span>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>eta</span> <span class=o>=</span> <span class=n>eta</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>        <span class=bp>self</span><span class=o>.</span><span class=n>weights</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>        <span class=bp>self</span><span class=o>.</span><span class=n>biases</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>        <span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span> <span class=o>=</span> <span class=p>[</span><span class=n>n_features</span><span class=p>]</span> <span class=o>+</span> <span class=n>n_neurons_per_layer</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>            <span class=n>w</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randn</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>],</span> <span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>*</span> <span class=mf>0.1</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a>            <span class=n>b</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>layer_dims</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>],))</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a>            <span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>            <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>        <span class=c1># histórico de treino</span>
</span><span id=__span-9-29><a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a>        <span class=bp>self</span><span class=o>.</span><span class=n>history</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"loss"</span><span class=p>:</span> <span class=p>[],</span> <span class=s2>"accuracy"</span><span class=p>:</span> <span class=p>[]}</span>
</span><span id=__span-9-30><a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>
</span><span id=__span-9-31><a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== Inicialização de Pesos e Biases ==="</span><span class=p>)</span>
</span><span id=__span-9-32><a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>)):</span>
</span><span id=__span-9-33><a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Camada </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>:"</span><span class=p>)</span>
</span><span id=__span-9-34><a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"W</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> shape </span><span class=si>{</span><span class=n>w</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>:</span><span class=se>\n</span><span class=si>{</span><span class=n>w</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-9-35><a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"b</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> shape </span><span class=si>{</span><span class=n>b</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>:</span><span class=se>\n</span><span class=si>{</span><span class=n>b</span><span class=si>}</span><span class=se>\n</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-9-36><a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a>
</span><span id=__span-9-37><a id=__codelineno-9-37 name=__codelineno-9-37 href=#__codelineno-9-37></a>    <span class=k>def</span><span class=w> </span><span class=nf>train</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>threshold</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>5e-3</span><span class=p>,</span> <span class=n>window</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-9-38><a id=__codelineno-9-38 name=__codelineno-9-38 href=#__codelineno-9-38></a>        <span class=n>loss_history</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-39><a id=__codelineno-9-39 name=__codelineno-9-39 href=#__codelineno-9-39></a>
</span><span id=__span-9-40><a id=__codelineno-9-40 name=__codelineno-9-40 href=#__codelineno-9-40></a>        <span class=k>for</span> <span class=n>epoch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>epochs</span><span class=p>):</span>
</span><span id=__span-9-41><a id=__codelineno-9-41 name=__codelineno-9-41 href=#__codelineno-9-41></a>            <span class=n>total_loss</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-9-42><a id=__codelineno-9-42 name=__codelineno-9-42 href=#__codelineno-9-42></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
</span><span id=__span-9-43><a id=__codelineno-9-43 name=__codelineno-9-43 href=#__codelineno-9-43></a>                <span class=n>y_pred</span><span class=p>,</span> <span class=n>cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward_pass</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-9-44><a id=__codelineno-9-44 name=__codelineno-9-44 href=#__codelineno-9-44></a>                <span class=n>loss</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss_calculation</span><span class=p>(</span><span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-45><a id=__codelineno-9-45 name=__codelineno-9-45 href=#__codelineno-9-45></a>                <span class=n>total_loss</span> <span class=o>+=</span> <span class=n>loss</span>
</span><span id=__span-9-46><a id=__codelineno-9-46 name=__codelineno-9-46 href=#__codelineno-9-46></a>                <span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>backpropagation</span><span class=p>(</span><span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>y_pred</span><span class=p>,</span> <span class=n>cache</span><span class=p>)</span>
</span><span id=__span-9-47><a id=__codelineno-9-47 name=__codelineno-9-47 href=#__codelineno-9-47></a>                <span class=bp>self</span><span class=o>.</span><span class=n>update_parameters</span><span class=p>(</span><span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span><span class=p>)</span>
</span><span id=__span-9-48><a id=__codelineno-9-48 name=__codelineno-9-48 href=#__codelineno-9-48></a>
</span><span id=__span-9-49><a id=__codelineno-9-49 name=__codelineno-9-49 href=#__codelineno-9-49></a>            <span class=n>avg_loss</span> <span class=o>=</span> <span class=n>total_loss</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span><span id=__span-9-50><a id=__codelineno-9-50 name=__codelineno-9-50 href=#__codelineno-9-50></a>            <span class=n>loss_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>avg_loss</span><span class=p>)</span>
</span><span id=__span-9-51><a id=__codelineno-9-51 name=__codelineno-9-51 href=#__codelineno-9-51></a>
</span><span id=__span-9-52><a id=__codelineno-9-52 name=__codelineno-9-52 href=#__codelineno-9-52></a>            <span class=n>preds_train</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>test</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-9-53><a id=__codelineno-9-53 name=__codelineno-9-53 href=#__codelineno-9-53></a>            <span class=n>train_acc</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_accuracy</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>preds_train</span><span class=p>)</span>
</span><span id=__span-9-54><a id=__codelineno-9-54 name=__codelineno-9-54 href=#__codelineno-9-54></a>
</span><span id=__span-9-55><a id=__codelineno-9-55 name=__codelineno-9-55 href=#__codelineno-9-55></a>            <span class=c1># armazenar no histórico</span>
</span><span id=__span-9-56><a id=__codelineno-9-56 name=__codelineno-9-56 href=#__codelineno-9-56></a>            <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=p>[</span><span class=s2>"loss"</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>avg_loss</span><span class=p>)</span>
</span><span id=__span-9-57><a id=__codelineno-9-57 name=__codelineno-9-57 href=#__codelineno-9-57></a>            <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=p>[</span><span class=s2>"accuracy"</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>train_acc</span><span class=p>)</span>
</span><span id=__span-9-58><a id=__codelineno-9-58 name=__codelineno-9-58 href=#__codelineno-9-58></a>
</span><span id=__span-9-59><a id=__codelineno-9-59 name=__codelineno-9-59 href=#__codelineno-9-59></a>            <span class=k>if</span> <span class=n>epoch</span> <span class=o>%</span> <span class=mi>10</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-9-60><a id=__codelineno-9-60 name=__codelineno-9-60 href=#__codelineno-9-60></a>                <span class=n>acc_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>train_acc</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%"</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>train_acc</span><span class=p>)</span> <span class=k>else</span> <span class=s2>"nan"</span>
</span><span id=__span-9-61><a id=__codelineno-9-61 name=__codelineno-9-61 href=#__codelineno-9-61></a>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2>, Loss: </span><span class=si>{</span><span class=n>avg_loss</span><span class=si>:</span><span class=s2>.6f</span><span class=si>}</span><span class=s2>, Train Acc: </span><span class=si>{</span><span class=n>acc_str</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-9-62><a id=__codelineno-9-62 name=__codelineno-9-62 href=#__codelineno-9-62></a>
</span><span id=__span-9-63><a id=__codelineno-9-63 name=__codelineno-9-63 href=#__codelineno-9-63></a>            <span class=c1># critério de parada: média móvel dos últimos "window" epochs</span>
</span><span id=__span-9-64><a id=__codelineno-9-64 name=__codelineno-9-64 href=#__codelineno-9-64></a>            <span class=k>if</span> <span class=n>epoch</span> <span class=o>&gt;=</span> <span class=n>window</span><span class=p>:</span>
</span><span id=__span-9-65><a id=__codelineno-9-65 name=__codelineno-9-65 href=#__codelineno-9-65></a>                <span class=n>moving_avg_prev</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>loss_history</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=o>*</span><span class=n>window</span><span class=p>:</span><span class=o>-</span><span class=n>window</span><span class=p>])</span>
</span><span id=__span-9-66><a id=__codelineno-9-66 name=__codelineno-9-66 href=#__codelineno-9-66></a>                <span class=n>moving_avg_curr</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>loss_history</span><span class=p>[</span><span class=o>-</span><span class=n>window</span><span class=p>:])</span>
</span><span id=__span-9-67><a id=__codelineno-9-67 name=__codelineno-9-67 href=#__codelineno-9-67></a>                <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>moving_avg_prev</span> <span class=o>-</span> <span class=n>moving_avg_curr</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>threshold</span><span class=p>:</span>
</span><span id=__span-9-68><a id=__codelineno-9-68 name=__codelineno-9-68 href=#__codelineno-9-68></a>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Treinamento encerrado no epoch </span><span class=si>{</span><span class=n>epoch</span><span class=si>}</span><span class=s2> (convergência detectada)."</span><span class=p>)</span>
</span><span id=__span-9-69><a id=__codelineno-9-69 name=__codelineno-9-69 href=#__codelineno-9-69></a>                    <span class=k>break</span>
</span><span id=__span-9-70><a id=__codelineno-9-70 name=__codelineno-9-70 href=#__codelineno-9-70></a>
</span><span id=__span-9-71><a id=__codelineno-9-71 name=__codelineno-9-71 href=#__codelineno-9-71></a>    <span class=k>def</span><span class=w> </span><span class=nf>test</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-72><a id=__codelineno-9-72 name=__codelineno-9-72 href=#__codelineno-9-72></a>        <span class=n>preds</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-73><a id=__codelineno-9-73 name=__codelineno-9-73 href=#__codelineno-9-73></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>X</span><span class=p>)):</span> 
</span><span id=__span-9-74><a id=__codelineno-9-74 name=__codelineno-9-74 href=#__codelineno-9-74></a>            <span class=n>y_pred</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward_pass</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-9-75><a id=__codelineno-9-75 name=__codelineno-9-75 href=#__codelineno-9-75></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-9-76><a id=__codelineno-9-76 name=__codelineno-9-76 href=#__codelineno-9-76></a>                <span class=n>preds</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-9-77><a id=__codelineno-9-77 name=__codelineno-9-77 href=#__codelineno-9-77></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-78><a id=__codelineno-9-78 name=__codelineno-9-78 href=#__codelineno-9-78></a>                <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>y_pred</span><span class=p>)</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>
</span><span id=__span-9-79><a id=__codelineno-9-79 name=__codelineno-9-79 href=#__codelineno-9-79></a>                <span class=n>v</span> <span class=o>=</span> <span class=n>val</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>val</span><span class=o>.</span><span class=n>size</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>val</span>
</span><span id=__span-9-80><a id=__codelineno-9-80 name=__codelineno-9-80 href=#__codelineno-9-80></a>                <span class=n>preds</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=mi>1</span> <span class=k>if</span> <span class=n>v</span> <span class=o>&gt;</span> <span class=mf>0.5</span> <span class=k>else</span> <span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-81><a id=__codelineno-9-81 name=__codelineno-9-81 href=#__codelineno-9-81></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>preds</span><span class=p>)</span>
</span><span id=__span-9-82><a id=__codelineno-9-82 name=__codelineno-9-82 href=#__codelineno-9-82></a>
</span><span id=__span-9-83><a id=__codelineno-9-83 name=__codelineno-9-83 href=#__codelineno-9-83></a>
</span><span id=__span-9-84><a id=__codelineno-9-84 name=__codelineno-9-84 href=#__codelineno-9-84></a>    <span class=k>def</span><span class=w> </span><span class=nf>evaluate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>plot_confusion</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span> <span class=n>plot_roc</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span> <span class=n>preds</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-9-85><a id=__codelineno-9-85 name=__codelineno-9-85 href=#__codelineno-9-85></a>        <span class=n>acc</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_accuracy</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>preds</span><span class=p>)</span>
</span><span id=__span-9-86><a id=__codelineno-9-86 name=__codelineno-9-86 href=#__codelineno-9-86></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Accuracy: </span><span class=si>{</span><span class=n>acc</span><span class=o>*</span><span class=mi>100</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>%"</span><span class=p>)</span>
</span><span id=__span-9-87><a id=__codelineno-9-87 name=__codelineno-9-87 href=#__codelineno-9-87></a>
</span><span id=__span-9-88><a id=__codelineno-9-88 name=__codelineno-9-88 href=#__codelineno-9-88></a>        <span class=nb>print</span><span class=p>(</span><span class=s2>"</span><span class=se>\n</span><span class=s2>=== Pesos e Biases do Modelo ==="</span><span class=p>)</span>
</span><span id=__span-9-89><a id=__codelineno-9-89 name=__codelineno-9-89 href=#__codelineno-9-89></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=nb>zip</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>)):</span>
</span><span id=__span-9-90><a id=__codelineno-9-90 name=__codelineno-9-90 href=#__codelineno-9-90></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=se>\n</span><span class=s2>Camada </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>:"</span><span class=p>)</span>
</span><span id=__span-9-91><a id=__codelineno-9-91 name=__codelineno-9-91 href=#__codelineno-9-91></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Pesos W</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> (shape </span><span class=si>{</span><span class=n>w</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>):"</span><span class=p>)</span>
</span><span id=__span-9-92><a id=__codelineno-9-92 name=__codelineno-9-92 href=#__codelineno-9-92></a>            <span class=nb>print</span><span class=p>(</span><span class=n>w</span><span class=p>)</span>
</span><span id=__span-9-93><a id=__codelineno-9-93 name=__codelineno-9-93 href=#__codelineno-9-93></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"  Biases b</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2> (shape </span><span class=si>{</span><span class=n>b</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>):"</span><span class=p>)</span>
</span><span id=__span-9-94><a id=__codelineno-9-94 name=__codelineno-9-94 href=#__codelineno-9-94></a>            <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-9-95><a id=__codelineno-9-95 name=__codelineno-9-95 href=#__codelineno-9-95></a>
</span><span id=__span-9-96><a id=__codelineno-9-96 name=__codelineno-9-96 href=#__codelineno-9-96></a>        <span class=n>binary</span> <span class=o>=</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y</span><span class=p>))</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-9-97><a id=__codelineno-9-97 name=__codelineno-9-97 href=#__codelineno-9-97></a>
</span><span id=__span-9-98><a id=__codelineno-9-98 name=__codelineno-9-98 href=#__codelineno-9-98></a>        <span class=k>if</span> <span class=n>plot_confusion</span><span class=p>:</span>
</span><span id=__span-9-99><a id=__codelineno-9-99 name=__codelineno-9-99 href=#__codelineno-9-99></a>            <span class=bp>self</span><span class=o>.</span><span class=n>plot_confusion_matrix</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>preds</span><span class=p>)</span>
</span><span id=__span-9-100><a id=__codelineno-9-100 name=__codelineno-9-100 href=#__codelineno-9-100></a>
</span><span id=__span-9-101><a id=__codelineno-9-101 name=__codelineno-9-101 href=#__codelineno-9-101></a>        <span class=k>if</span> <span class=n>plot_roc</span> <span class=ow>and</span> <span class=n>binary</span><span class=p>:</span>
</span><span id=__span-9-102><a id=__codelineno-9-102 name=__codelineno-9-102 href=#__codelineno-9-102></a>            <span class=bp>self</span><span class=o>.</span><span class=n>plot_roc_curve</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span><span id=__span-9-103><a id=__codelineno-9-103 name=__codelineno-9-103 href=#__codelineno-9-103></a>
</span><span id=__span-9-104><a id=__codelineno-9-104 name=__codelineno-9-104 href=#__codelineno-9-104></a>        <span class=c1># sempre plota histórico se existir</span>
</span><span id=__span-9-105><a id=__codelineno-9-105 name=__codelineno-9-105 href=#__codelineno-9-105></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>history</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"loss"</span><span class=p>,</span> <span class=p>[]))</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-9-106><a id=__codelineno-9-106 name=__codelineno-9-106 href=#__codelineno-9-106></a>            <span class=bp>self</span><span class=o>.</span><span class=n>plot_history</span><span class=p>()</span>
</span><span id=__span-9-107><a id=__codelineno-9-107 name=__codelineno-9-107 href=#__codelineno-9-107></a>
</span><span id=__span-9-108><a id=__codelineno-9-108 name=__codelineno-9-108 href=#__codelineno-9-108></a>    <span class=c1># -------- Funções auxiliares de plot --------</span>
</span><span id=__span-9-109><a id=__codelineno-9-109 name=__codelineno-9-109 href=#__codelineno-9-109></a>    <span class=k>def</span><span class=w> </span><span class=nf>plot_confusion_matrix</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>):</span>
</span><span id=__span-9-110><a id=__codelineno-9-110 name=__codelineno-9-110 href=#__codelineno-9-110></a>        <span class=n>cm</span> <span class=o>=</span> <span class=n>confusion_matrix</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-111><a id=__codelineno-9-111 name=__codelineno-9-111 href=#__codelineno-9-111></a>        <span class=n>cm_norm</span> <span class=o>=</span> <span class=n>cm</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s2>"float"</span><span class=p>)</span> <span class=o>/</span> <span class=n>cm</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)[:,</span> <span class=n>np</span><span class=o>.</span><span class=n>newaxis</span><span class=p>]</span>
</span><span id=__span-9-112><a id=__codelineno-9-112 name=__codelineno-9-112 href=#__codelineno-9-112></a>
</span><span id=__span-9-113><a id=__codelineno-9-113 name=__codelineno-9-113 href=#__codelineno-9-113></a>        <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mi>5</span><span class=p>))</span>
</span><span id=__span-9-114><a id=__codelineno-9-114 name=__codelineno-9-114 href=#__codelineno-9-114></a>        <span class=n>sns</span><span class=o>.</span><span class=n>heatmap</span><span class=p>(</span><span class=n>cm_norm</span><span class=p>,</span> <span class=n>annot</span><span class=o>=</span><span class=n>cm</span><span class=p>,</span> <span class=n>fmt</span><span class=o>=</span><span class=s2>"d"</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s2>"Blues"</span><span class=p>,</span>
</span><span id=__span-9-115><a id=__codelineno-9-115 name=__codelineno-9-115 href=#__codelineno-9-115></a>                    <span class=n>xticklabels</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y_true</span><span class=p>),</span>
</span><span id=__span-9-116><a id=__codelineno-9-116 name=__codelineno-9-116 href=#__codelineno-9-116></a>                    <span class=n>yticklabels</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>y_true</span><span class=p>))</span>
</span><span id=__span-9-117><a id=__codelineno-9-117 name=__codelineno-9-117 href=#__codelineno-9-117></a>        <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>"Confusion Matrix (normalized by row)"</span><span class=p>)</span>
</span><span id=__span-9-118><a id=__codelineno-9-118 name=__codelineno-9-118 href=#__codelineno-9-118></a>        <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>"Predicted"</span><span class=p>)</span>
</span><span id=__span-9-119><a id=__codelineno-9-119 name=__codelineno-9-119 href=#__codelineno-9-119></a>        <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>"True"</span><span class=p>)</span>
</span><span id=__span-9-120><a id=__codelineno-9-120 name=__codelineno-9-120 href=#__codelineno-9-120></a>        <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-9-121><a id=__codelineno-9-121 name=__codelineno-9-121 href=#__codelineno-9-121></a>
</span><span id=__span-9-122><a id=__codelineno-9-122 name=__codelineno-9-122 href=#__codelineno-9-122></a>    <span class=k>def</span><span class=w> </span><span class=nf>plot_roc_curve</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y_true</span><span class=p>):</span>
</span><span id=__span-9-123><a id=__codelineno-9-123 name=__codelineno-9-123 href=#__codelineno-9-123></a>        <span class=n>y_scores</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-9-124><a id=__codelineno-9-124 name=__codelineno-9-124 href=#__codelineno-9-124></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>X</span><span class=p>)):</span>
</span><span id=__span-9-125><a id=__codelineno-9-125 name=__codelineno-9-125 href=#__codelineno-9-125></a>            <span class=n>y_pred</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>forward_pass</span><span class=p>(</span><span class=n>X</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-9-126><a id=__codelineno-9-126 name=__codelineno-9-126 href=#__codelineno-9-126></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-9-127><a id=__codelineno-9-127 name=__codelineno-9-127 href=#__codelineno-9-127></a>                <span class=n>y_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>y_pred</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-9-128><a id=__codelineno-9-128 name=__codelineno-9-128 href=#__codelineno-9-128></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-129><a id=__codelineno-9-129 name=__codelineno-9-129 href=#__codelineno-9-129></a>                <span class=n>val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>y_pred</span><span class=p>)</span><span class=o>.</span><span class=n>ravel</span><span class=p>()</span>
</span><span id=__span-9-130><a id=__codelineno-9-130 name=__codelineno-9-130 href=#__codelineno-9-130></a>                <span class=n>y_scores</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>val</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>val</span><span class=o>.</span><span class=n>size</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>val</span><span class=p>)</span>
</span><span id=__span-9-131><a id=__codelineno-9-131 name=__codelineno-9-131 href=#__codelineno-9-131></a>        <span class=n>y_scores</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>y_scores</span><span class=p>)</span>
</span><span id=__span-9-132><a id=__codelineno-9-132 name=__codelineno-9-132 href=#__codelineno-9-132></a>
</span><span id=__span-9-133><a id=__codelineno-9-133 name=__codelineno-9-133 href=#__codelineno-9-133></a>        <span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>roc_curve</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_scores</span><span class=p>)</span>
</span><span id=__span-9-134><a id=__codelineno-9-134 name=__codelineno-9-134 href=#__codelineno-9-134></a>        <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>auc</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>)</span>
</span><span id=__span-9-135><a id=__codelineno-9-135 name=__codelineno-9-135 href=#__codelineno-9-135></a>
</span><span id=__span-9-136><a id=__codelineno-9-136 name=__codelineno-9-136 href=#__codelineno-9-136></a>        <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span><span id=__span-9-137><a id=__codelineno-9-137 name=__codelineno-9-137 href=#__codelineno-9-137></a>        <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>fpr</span><span class=p>,</span> <span class=n>tpr</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>"darkorange"</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-9-138><a id=__codelineno-9-138 name=__codelineno-9-138 href=#__codelineno-9-138></a>                 <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s2>"ROC curve (area = </span><span class=si>{</span><span class=n>roc_auc</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>)"</span><span class=p>)</span>
</span><span id=__span-9-139><a id=__codelineno-9-139 name=__codelineno-9-139 href=#__codelineno-9-139></a>        <span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=s2>"navy"</span><span class=p>,</span> <span class=n>lw</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>"--"</span><span class=p>)</span>
</span><span id=__span-9-140><a id=__codelineno-9-140 name=__codelineno-9-140 href=#__codelineno-9-140></a>        <span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>"False Positive Rate"</span><span class=p>)</span>
</span><span id=__span-9-141><a id=__codelineno-9-141 name=__codelineno-9-141 href=#__codelineno-9-141></a>        <span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>"True Positive Rate"</span><span class=p>)</span>
</span><span id=__span-9-142><a id=__codelineno-9-142 name=__codelineno-9-142 href=#__codelineno-9-142></a>        <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s2>"Receiver Operating Characteristic (ROC)"</span><span class=p>)</span>
</span><span id=__span-9-143><a id=__codelineno-9-143 name=__codelineno-9-143 href=#__codelineno-9-143></a>        <span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s2>"lower right"</span><span class=p>)</span>
</span><span id=__span-9-144><a id=__codelineno-9-144 name=__codelineno-9-144 href=#__codelineno-9-144></a>        <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-9-145><a id=__codelineno-9-145 name=__codelineno-9-145 href=#__codelineno-9-145></a>
</span><span id=__span-9-146><a id=__codelineno-9-146 name=__codelineno-9-146 href=#__codelineno-9-146></a>    <span class=k>def</span><span class=w> </span><span class=nf>plot_history</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-9-147><a id=__codelineno-9-147 name=__codelineno-9-147 href=#__codelineno-9-147></a><span class=w>        </span><span class=sd>"""Plota loss e accuracy armazenados em self.history."""</span>
</span><span id=__span-9-148><a id=__codelineno-9-148 name=__codelineno-9-148 href=#__codelineno-9-148></a>        <span class=n>loss</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"loss"</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-9-149><a id=__codelineno-9-149 name=__codelineno-9-149 href=#__codelineno-9-149></a>        <span class=n>acc</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>"accuracy"</span><span class=p>,</span> <span class=p>[])</span>
</span><span id=__span-9-150><a id=__codelineno-9-150 name=__codelineno-9-150 href=#__codelineno-9-150></a>        <span class=n>epochs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>loss</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-9-151><a id=__codelineno-9-151 name=__codelineno-9-151 href=#__codelineno-9-151></a>
</span><span id=__span-9-152><a id=__codelineno-9-152 name=__codelineno-9-152 href=#__codelineno-9-152></a>        <span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-9-153><a id=__codelineno-9-153 name=__codelineno-9-153 href=#__codelineno-9-153></a>        <span class=c1># loss</span>
</span><span id=__span-9-154><a id=__codelineno-9-154 name=__codelineno-9-154 href=#__codelineno-9-154></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>epochs</span><span class=p>,</span> <span class=n>loss</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s2>"o"</span><span class=p>)</span>
</span><span id=__span-9-155><a id=__codelineno-9-155 name=__codelineno-9-155 href=#__codelineno-9-155></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>"Loss por Epoch"</span><span class=p>)</span>
</span><span id=__span-9-156><a id=__codelineno-9-156 name=__codelineno-9-156 href=#__codelineno-9-156></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>"Epoch"</span><span class=p>)</span>
</span><span id=__span-9-157><a id=__codelineno-9-157 name=__codelineno-9-157 href=#__codelineno-9-157></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>"Loss"</span><span class=p>)</span>
</span><span id=__span-9-158><a id=__codelineno-9-158 name=__codelineno-9-158 href=#__codelineno-9-158></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>"--"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.4</span><span class=p>)</span>
</span><span id=__span-9-159><a id=__codelineno-9-159 name=__codelineno-9-159 href=#__codelineno-9-159></a>        <span class=c1># accuracy</span>
</span><span id=__span-9-160><a id=__codelineno-9-160 name=__codelineno-9-160 href=#__codelineno-9-160></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>epochs</span><span class=p>,</span> <span class=n>acc</span><span class=p>,</span> <span class=n>marker</span><span class=o>=</span><span class=s2>"o"</span><span class=p>)</span>
</span><span id=__span-9-161><a id=__codelineno-9-161 name=__codelineno-9-161 href=#__codelineno-9-161></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=s2>"Accuracy por Epoch (treino)"</span><span class=p>)</span>
</span><span id=__span-9-162><a id=__codelineno-9-162 name=__codelineno-9-162 href=#__codelineno-9-162></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=s2>"Epoch"</span><span class=p>)</span>
</span><span id=__span-9-163><a id=__codelineno-9-163 name=__codelineno-9-163 href=#__codelineno-9-163></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>"Accuracy"</span><span class=p>)</span>
</span><span id=__span-9-164><a id=__codelineno-9-164 name=__codelineno-9-164 href=#__codelineno-9-164></a>        <span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>True</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>"--"</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.4</span><span class=p>)</span>
</span><span id=__span-9-165><a id=__codelineno-9-165 name=__codelineno-9-165 href=#__codelineno-9-165></a>
</span><span id=__span-9-166><a id=__codelineno-9-166 name=__codelineno-9-166 href=#__codelineno-9-166></a>        <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-9-167><a id=__codelineno-9-167 name=__codelineno-9-167 href=#__codelineno-9-167></a>        <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-9-168><a id=__codelineno-9-168 name=__codelineno-9-168 href=#__codelineno-9-168></a>
</span><span id=__span-9-169><a id=__codelineno-9-169 name=__codelineno-9-169 href=#__codelineno-9-169></a>    <span class=k>def</span><span class=w> </span><span class=nf>calculate_accuracy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-9-170><a id=__codelineno-9-170 name=__codelineno-9-170 href=#__codelineno-9-170></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>y_true</span> <span class=o>==</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-171><a id=__codelineno-9-171 name=__codelineno-9-171 href=#__codelineno-9-171></a>
</span><span id=__span-9-172><a id=__codelineno-9-172 name=__codelineno-9-172 href=#__codelineno-9-172></a>    <span class=k>def</span><span class=w> </span><span class=nf>forward_pass</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>:</span>
</span><span id=__span-9-173><a id=__codelineno-9-173 name=__codelineno-9-173 href=#__codelineno-9-173></a>        <span class=n>a</span> <span class=o>=</span> <span class=n>x</span>
</span><span id=__span-9-174><a id=__codelineno-9-174 name=__codelineno-9-174 href=#__codelineno-9-174></a>        <span class=n>cache</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"z"</span><span class=p>:</span> <span class=p>[],</span> <span class=s2>"a"</span><span class=p>:</span> <span class=p>[</span><span class=n>a</span><span class=p>]}</span>
</span><span id=__span-9-175><a id=__codelineno-9-175 name=__codelineno-9-175 href=#__codelineno-9-175></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)):</span>
</span><span id=__span-9-176><a id=__codelineno-9-176 name=__codelineno-9-176 href=#__codelineno-9-176></a>            <span class=n>z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>a</span><span class=p>)</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-9-177><a id=__codelineno-9-177 name=__codelineno-9-177 href=#__codelineno-9-177></a>            <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-9-178><a id=__codelineno-9-178 name=__codelineno-9-178 href=#__codelineno-9-178></a>                <span class=n>a</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-179><a id=__codelineno-9-179 name=__codelineno-9-179 href=#__codelineno-9-179></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-180><a id=__codelineno-9-180 name=__codelineno-9-180 href=#__codelineno-9-180></a>                <span class=n>a</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation_function</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-181><a id=__codelineno-9-181 name=__codelineno-9-181 href=#__codelineno-9-181></a>            <span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-182><a id=__codelineno-9-182 name=__codelineno-9-182 href=#__codelineno-9-182></a>            <span class=n>cache</span><span class=p>[</span><span class=s2>"a"</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span><span id=__span-9-183><a id=__codelineno-9-183 name=__codelineno-9-183 href=#__codelineno-9-183></a>        <span class=k>return</span> <span class=n>a</span><span class=p>,</span> <span class=n>cache</span>
</span><span id=__span-9-184><a id=__codelineno-9-184 name=__codelineno-9-184 href=#__codelineno-9-184></a>
</span><span id=__span-9-185><a id=__codelineno-9-185 name=__codelineno-9-185 href=#__codelineno-9-185></a>    <span class=k>def</span><span class=w> </span><span class=nf>backpropagation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>cache</span><span class=p>:</span> <span class=nb>dict</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>:</span>
</span><span id=__span-9-186><a id=__codelineno-9-186 name=__codelineno-9-186 href=#__codelineno-9-186></a>        <span class=n>grads_w</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)</span>
</span><span id=__span-9-187><a id=__codelineno-9-187 name=__codelineno-9-187 href=#__codelineno-9-187></a>        <span class=n>grads_b</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>)</span>
</span><span id=__span-9-188><a id=__codelineno-9-188 name=__codelineno-9-188 href=#__codelineno-9-188></a>
</span><span id=__span-9-189><a id=__codelineno-9-189 name=__codelineno-9-189 href=#__codelineno-9-189></a>        <span class=c1># Última camada</span>
</span><span id=__span-9-190><a id=__codelineno-9-190 name=__codelineno-9-190 href=#__codelineno-9-190></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"cross_entropy"</span><span class=p>:</span>
</span><span id=__span-9-191><a id=__codelineno-9-191 name=__codelineno-9-191 href=#__codelineno-9-191></a>            <span class=n>delta</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_cross_entropy</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-192><a id=__codelineno-9-192 name=__codelineno-9-192 href=#__codelineno-9-192></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s2>"mse"</span><span class=p>:</span>
</span><span id=__span-9-193><a id=__codelineno-9-193 name=__codelineno-9-193 href=#__codelineno-9-193></a>            <span class=n>dloss_dy_pred</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-194><a id=__codelineno-9-194 name=__codelineno-9-194 href=#__codelineno-9-194></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"sigmoid"</span><span class=p>:</span>
</span><span id=__span-9-195><a id=__codelineno-9-195 name=__codelineno-9-195 href=#__codelineno-9-195></a>                <span class=n>delta</span> <span class=o>=</span> <span class=n>dloss_dy_pred</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_sigmoid</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-9-196><a id=__codelineno-9-196 name=__codelineno-9-196 href=#__codelineno-9-196></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"tanh"</span><span class=p>:</span>
</span><span id=__span-9-197><a id=__codelineno-9-197 name=__codelineno-9-197 href=#__codelineno-9-197></a>                <span class=n>delta</span> <span class=o>=</span> <span class=n>dloss_dy_pred</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_tanh</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-9-198><a id=__codelineno-9-198 name=__codelineno-9-198 href=#__codelineno-9-198></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"relu"</span><span class=p>:</span>
</span><span id=__span-9-199><a id=__codelineno-9-199 name=__codelineno-9-199 href=#__codelineno-9-199></a>                <span class=n>delta</span> <span class=o>=</span> <span class=n>dloss_dy_pred</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_relu</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-9-200><a id=__codelineno-9-200 name=__codelineno-9-200 href=#__codelineno-9-200></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-201><a id=__codelineno-9-201 name=__codelineno-9-201 href=#__codelineno-9-201></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>"Loss não suportada"</span><span class=p>)</span>
</span><span id=__span-9-202><a id=__codelineno-9-202 name=__codelineno-9-202 href=#__codelineno-9-202></a>
</span><span id=__span-9-203><a id=__codelineno-9-203 name=__codelineno-9-203 href=#__codelineno-9-203></a>        <span class=n>grads_w</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>delta</span><span class=p>,</span> <span class=n>cache</span><span class=p>[</span><span class=s2>"a"</span><span class=p>][</span><span class=o>-</span><span class=mi>2</span><span class=p>])</span>
</span><span id=__span-9-204><a id=__codelineno-9-204 name=__codelineno-9-204 href=#__codelineno-9-204></a>        <span class=n>grads_b</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>delta</span>
</span><span id=__span-9-205><a id=__codelineno-9-205 name=__codelineno-9-205 href=#__codelineno-9-205></a>
</span><span id=__span-9-206><a id=__codelineno-9-206 name=__codelineno-9-206 href=#__codelineno-9-206></a>        <span class=c1># Camadas ocultas</span>
</span><span id=__span-9-207><a id=__codelineno-9-207 name=__codelineno-9-207 href=#__codelineno-9-207></a>        <span class=k>for</span> <span class=n>l</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)):</span>
</span><span id=__span-9-208><a id=__codelineno-9-208 name=__codelineno-9-208 href=#__codelineno-9-208></a>            <span class=n>delta</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>[</span><span class=n>l</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>T</span><span class=p>,</span> <span class=n>delta</span><span class=p>)</span>
</span><span id=__span-9-209><a id=__codelineno-9-209 name=__codelineno-9-209 href=#__codelineno-9-209></a>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"sigmoid"</span><span class=p>:</span>
</span><span id=__span-9-210><a id=__codelineno-9-210 name=__codelineno-9-210 href=#__codelineno-9-210></a>                <span class=n>delta</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_sigmoid</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-9-211><a id=__codelineno-9-211 name=__codelineno-9-211 href=#__codelineno-9-211></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"tanh"</span><span class=p>:</span>
</span><span id=__span-9-212><a id=__codelineno-9-212 name=__codelineno-9-212 href=#__codelineno-9-212></a>                <span class=n>delta</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_tanh</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-9-213><a id=__codelineno-9-213 name=__codelineno-9-213 href=#__codelineno-9-213></a>            <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s2>"relu"</span><span class=p>:</span>
</span><span id=__span-9-214><a id=__codelineno-9-214 name=__codelineno-9-214 href=#__codelineno-9-214></a>                <span class=n>delta</span> <span class=o>*=</span> <span class=bp>self</span><span class=o>.</span><span class=n>derive_relu</span><span class=p>(</span><span class=n>cache</span><span class=p>[</span><span class=s2>"z"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-9-215><a id=__codelineno-9-215 name=__codelineno-9-215 href=#__codelineno-9-215></a>            <span class=n>grads_w</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>outer</span><span class=p>(</span><span class=n>delta</span><span class=p>,</span> <span class=n>cache</span><span class=p>[</span><span class=s2>"a"</span><span class=p>][</span><span class=n>l</span><span class=p>])</span>
</span><span id=__span-9-216><a id=__codelineno-9-216 name=__codelineno-9-216 href=#__codelineno-9-216></a>            <span class=n>grads_b</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=n>delta</span>
</span><span id=__span-9-217><a id=__codelineno-9-217 name=__codelineno-9-217 href=#__codelineno-9-217></a>
</span><span id=__span-9-218><a id=__codelineno-9-218 name=__codelineno-9-218 href=#__codelineno-9-218></a>        <span class=k>return</span> <span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span>
</span><span id=__span-9-219><a id=__codelineno-9-219 name=__codelineno-9-219 href=#__codelineno-9-219></a>
</span><span id=__span-9-220><a id=__codelineno-9-220 name=__codelineno-9-220 href=#__codelineno-9-220></a>    <span class=k>def</span><span class=w> </span><span class=nf>update_parameters</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>grads_w</span><span class=p>,</span> <span class=n>grads_b</span><span class=p>):</span>
</span><span id=__span-9-221><a id=__codelineno-9-221 name=__codelineno-9-221 href=#__codelineno-9-221></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>optimizer</span> <span class=o>==</span> <span class=s2>"gd"</span><span class=p>:</span>
</span><span id=__span-9-222><a id=__codelineno-9-222 name=__codelineno-9-222 href=#__codelineno-9-222></a>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>)):</span>
</span><span id=__span-9-223><a id=__codelineno-9-223 name=__codelineno-9-223 href=#__codelineno-9-223></a>                <span class=bp>self</span><span class=o>.</span><span class=n>weights</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>eta</span> <span class=o>*</span> <span class=n>grads_w</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-9-224><a id=__codelineno-9-224 name=__codelineno-9-224 href=#__codelineno-9-224></a>                <span class=bp>self</span><span class=o>.</span><span class=n>biases</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>  <span class=o>-=</span> <span class=bp>self</span><span class=o>.</span><span class=n>eta</span> <span class=o>*</span> <span class=n>grads_b</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-9-225><a id=__codelineno-9-225 name=__codelineno-9-225 href=#__codelineno-9-225></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-226><a id=__codelineno-9-226 name=__codelineno-9-226 href=#__codelineno-9-226></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Optimizer </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>optimizer</span><span class=si>}</span><span class=s2> não suportado"</span><span class=p>)</span>
</span><span id=__span-9-227><a id=__codelineno-9-227 name=__codelineno-9-227 href=#__codelineno-9-227></a>
</span><span id=__span-9-228><a id=__codelineno-9-228 name=__codelineno-9-228 href=#__codelineno-9-228></a>    <span class=k>def</span><span class=w> </span><span class=nf>loss_calculation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-9-229><a id=__codelineno-9-229 name=__codelineno-9-229 href=#__codelineno-9-229></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s1>'mse'</span><span class=p>:</span>
</span><span id=__span-9-230><a id=__codelineno-9-230 name=__codelineno-9-230 href=#__codelineno-9-230></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>mse</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-231><a id=__codelineno-9-231 name=__codelineno-9-231 href=#__codelineno-9-231></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>loss</span> <span class=o>==</span> <span class=s1>'cross_entropy'</span><span class=p>:</span>
</span><span id=__span-9-232><a id=__codelineno-9-232 name=__codelineno-9-232 href=#__codelineno-9-232></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cross_entropy</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-233><a id=__codelineno-9-233 name=__codelineno-9-233 href=#__codelineno-9-233></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-234><a id=__codelineno-9-234 name=__codelineno-9-234 href=#__codelineno-9-234></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Função de loss </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>loss</span><span class=si>}</span><span class=s2> não suportada"</span><span class=p>)</span>
</span><span id=__span-9-235><a id=__codelineno-9-235 name=__codelineno-9-235 href=#__codelineno-9-235></a>
</span><span id=__span-9-236><a id=__codelineno-9-236 name=__codelineno-9-236 href=#__codelineno-9-236></a>    <span class=k>def</span><span class=w> </span><span class=nf>activation_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-237><a id=__codelineno-9-237 name=__codelineno-9-237 href=#__codelineno-9-237></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s1>'sigmoid'</span><span class=p>:</span>
</span><span id=__span-9-238><a id=__codelineno-9-238 name=__codelineno-9-238 href=#__codelineno-9-238></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>sigmoid</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-239><a id=__codelineno-9-239 name=__codelineno-9-239 href=#__codelineno-9-239></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s1>'tanh'</span><span class=p>:</span>
</span><span id=__span-9-240><a id=__codelineno-9-240 name=__codelineno-9-240 href=#__codelineno-9-240></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-241><a id=__codelineno-9-241 name=__codelineno-9-241 href=#__codelineno-9-241></a>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>activation</span> <span class=o>==</span> <span class=s1>'relu'</span><span class=p>:</span>
</span><span id=__span-9-242><a id=__codelineno-9-242 name=__codelineno-9-242 href=#__codelineno-9-242></a>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-243><a id=__codelineno-9-243 name=__codelineno-9-243 href=#__codelineno-9-243></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-244><a id=__codelineno-9-244 name=__codelineno-9-244 href=#__codelineno-9-244></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Função de ativação </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>activation</span><span class=si>}</span><span class=s2> não suportada"</span><span class=p>)</span>
</span><span id=__span-9-245><a id=__codelineno-9-245 name=__codelineno-9-245 href=#__codelineno-9-245></a>
</span><span id=__span-9-246><a id=__codelineno-9-246 name=__codelineno-9-246 href=#__codelineno-9-246></a>    <span class=k>def</span><span class=w> </span><span class=nf>mse</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-9-247><a id=__codelineno-9-247 name=__codelineno-9-247 href=#__codelineno-9-247></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>((</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_pred</span><span class=p>)</span><span class=o>**</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-9-248><a id=__codelineno-9-248 name=__codelineno-9-248 href=#__codelineno-9-248></a>
</span><span id=__span-9-249><a id=__codelineno-9-249 name=__codelineno-9-249 href=#__codelineno-9-249></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_mse</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-250><a id=__codelineno-9-250 name=__codelineno-9-250 href=#__codelineno-9-250></a>        <span class=k>return</span> <span class=o>-</span><span class=mi>2</span><span class=o>*</span><span class=p>(</span><span class=n>y_true</span> <span class=o>-</span> <span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-251><a id=__codelineno-9-251 name=__codelineno-9-251 href=#__codelineno-9-251></a>
</span><span id=__span-9-252><a id=__codelineno-9-252 name=__codelineno-9-252 href=#__codelineno-9-252></a>    <span class=k>def</span><span class=w> </span><span class=nf>cross_entropy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span><span id=__span-9-253><a id=__codelineno-9-253 name=__codelineno-9-253 href=#__codelineno-9-253></a>        <span class=n>num_classes</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-254><a id=__codelineno-9-254 name=__codelineno-9-254 href=#__codelineno-9-254></a>        <span class=n>y_true_onehot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=n>num_classes</span><span class=p>)[</span><span class=n>y_true</span><span class=p>]</span>
</span><span id=__span-9-255><a id=__codelineno-9-255 name=__codelineno-9-255 href=#__codelineno-9-255></a>        <span class=n>eps</span> <span class=o>=</span> <span class=mf>1e-15</span>
</span><span id=__span-9-256><a id=__codelineno-9-256 name=__codelineno-9-256 href=#__codelineno-9-256></a>        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>y_pred</span><span class=p>,</span> <span class=n>eps</span><span class=p>,</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>eps</span><span class=p>)</span>
</span><span id=__span-9-257><a id=__codelineno-9-257 name=__codelineno-9-257 href=#__codelineno-9-257></a>        <span class=k>return</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>y_true_onehot</span> <span class=o>*</span> <span class=n>np</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>y_pred</span><span class=p>))</span>
</span><span id=__span-9-258><a id=__codelineno-9-258 name=__codelineno-9-258 href=#__codelineno-9-258></a>
</span><span id=__span-9-259><a id=__codelineno-9-259 name=__codelineno-9-259 href=#__codelineno-9-259></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_cross_entropy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>y_true</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-260><a id=__codelineno-9-260 name=__codelineno-9-260 href=#__codelineno-9-260></a>        <span class=n>num_classes</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>y_pred</span><span class=p>)</span>
</span><span id=__span-9-261><a id=__codelineno-9-261 name=__codelineno-9-261 href=#__codelineno-9-261></a>        <span class=n>y_true_onehot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>eye</span><span class=p>(</span><span class=n>num_classes</span><span class=p>)[</span><span class=n>y_true</span><span class=p>]</span>
</span><span id=__span-9-262><a id=__codelineno-9-262 name=__codelineno-9-262 href=#__codelineno-9-262></a>        <span class=k>return</span> <span class=n>y_pred</span> <span class=o>-</span> <span class=n>y_true_onehot</span>
</span><span id=__span-9-263><a id=__codelineno-9-263 name=__codelineno-9-263 href=#__codelineno-9-263></a>
</span><span id=__span-9-264><a id=__codelineno-9-264 name=__codelineno-9-264 href=#__codelineno-9-264></a>    <span class=k>def</span><span class=w> </span><span class=nf>sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-265><a id=__codelineno-9-265 name=__codelineno-9-265 href=#__codelineno-9-265></a>        <span class=k>return</span> <span class=mi>1</span> <span class=o>/</span> <span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>z</span><span class=p>))</span>
</span><span id=__span-9-266><a id=__codelineno-9-266 name=__codelineno-9-266 href=#__codelineno-9-266></a>
</span><span id=__span-9-267><a id=__codelineno-9-267 name=__codelineno-9-267 href=#__codelineno-9-267></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_sigmoid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-268><a id=__codelineno-9-268 name=__codelineno-9-268 href=#__codelineno-9-268></a>        <span class=n>s</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>sigmoid</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-269><a id=__codelineno-9-269 name=__codelineno-9-269 href=#__codelineno-9-269></a>        <span class=k>return</span> <span class=n>s</span> <span class=o>*</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>s</span><span class=p>)</span>
</span><span id=__span-9-270><a id=__codelineno-9-270 name=__codelineno-9-270 href=#__codelineno-9-270></a>
</span><span id=__span-9-271><a id=__codelineno-9-271 name=__codelineno-9-271 href=#__codelineno-9-271></a>    <span class=k>def</span><span class=w> </span><span class=nf>tanh</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-272><a id=__codelineno-9-272 name=__codelineno-9-272 href=#__codelineno-9-272></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-273><a id=__codelineno-9-273 name=__codelineno-9-273 href=#__codelineno-9-273></a>
</span><span id=__span-9-274><a id=__codelineno-9-274 name=__codelineno-9-274 href=#__codelineno-9-274></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_tanh</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-275><a id=__codelineno-9-275 name=__codelineno-9-275 href=#__codelineno-9-275></a>        <span class=k>return</span> <span class=mi>1</span> <span class=o>-</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>z</span><span class=p>))</span><span class=o>**</span><span class=mi>2</span>
</span><span id=__span-9-276><a id=__codelineno-9-276 name=__codelineno-9-276 href=#__codelineno-9-276></a>
</span><span id=__span-9-277><a id=__codelineno-9-277 name=__codelineno-9-277 href=#__codelineno-9-277></a>    <span class=k>def</span><span class=w> </span><span class=nf>relu</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-278><a id=__codelineno-9-278 name=__codelineno-9-278 href=#__codelineno-9-278></a>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>maximum</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>z</span><span class=p>)</span>
</span><span id=__span-9-279><a id=__codelineno-9-279 name=__codelineno-9-279 href=#__codelineno-9-279></a>
</span><span id=__span-9-280><a id=__codelineno-9-280 name=__codelineno-9-280 href=#__codelineno-9-280></a>    <span class=k>def</span><span class=w> </span><span class=nf>derive_relu</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-281><a id=__codelineno-9-281 name=__codelineno-9-281 href=#__codelineno-9-281></a>        <span class=k>return</span> <span class=p>(</span><span class=n>z</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>
</span><span id=__span-9-282><a id=__codelineno-9-282 name=__codelineno-9-282 href=#__codelineno-9-282></a>
</span><span id=__span-9-283><a id=__codelineno-9-283 name=__codelineno-9-283 href=#__codelineno-9-283></a>    <span class=k>def</span><span class=w> </span><span class=nf>softmax</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>z</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span><span id=__span-9-284><a id=__codelineno-9-284 name=__codelineno-9-284 href=#__codelineno-9-284></a>        <span class=n>exp_z</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>z</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=n>z</span><span class=p>))</span>
</span><span id=__span-9-285><a id=__codelineno-9-285 name=__codelineno-9-285 href=#__codelineno-9-285></a>        <span class=k>return</span> <span class=n>exp_z</span> <span class=o>/</span> <span class=n>np</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>exp_z</span><span class=p>)</span>
</span></code></pre></div> <h3 id=observe>Observe</h3> <p>Essa implementação de MLP permite que o usuário escolha o número de layers e seu tamanho (output também), permite que o usuário escolhe entre Relu, sigmoid ou tanh como função de ativação, disponibiliza cross-entropy ou MSE para calculo de erro, mas tem a limitação de que só permite o usuário escolher o Gradient Descent padrão (GD) como otimização, mas como ele trabalha em modo estocástico (atualiza peso em cada amostra), pode-se considerar um SGD.</p> <p>Por fim, existem alguns parâmetros chaves que podem ser alterados na chamada da classe que são cruciais para o funcionamento da rede neural. Eles são: learning rate ('eta' no código), epochs e o número de camadas ocultas, assim como o número de neurônios nela.</p> <h1 id=5-treinando-modelo>5. Treinando Modelo</h1> <p>Assim, temos a nossa MLP pronta, agora basta implementar, para isso utilizamos os seguintes parâmetros:</p> <p></p><div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>model</span> <span class=o>=</span> <span class=n>mlp</span><span class=p>(</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>    <span class=n>n_features</span><span class=o>=</span><span class=n>X_train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>    <span class=n>n_hidden_layers</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>    <span class=n>n_neurons_per_layer</span><span class=o>=</span><span class=p>[</span><span class=mi>32</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>    <span class=n>activation</span><span class=o>=</span><span class=s2>"relu"</span><span class=p>,</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>    <span class=n>loss</span><span class=o>=</span><span class=s2>"mse"</span><span class=p>,</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=n>optimizer</span><span class=o>=</span><span class=s2>"gd"</span><span class=p>,</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>    <span class=n>epochs</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=n>eta</span><span class=o>=</span><span class=mf>0.01</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=p>)</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=n>model</span><span class=o>.</span><span class=n>train</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span></code></pre></div> Quando fazemos model = mlp(...) os pesos e biases já são inicializados automaticamente:<p></p> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>=== Inicialização de Pesos e Biases ===
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>Camada 1:
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>W1 shape (32, 27):
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>[[ 1.15933603e-01 -1.81859311e-02  3.78720797e-02  1.61887445e-01
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>  -1.76264976e-02 -1.17896559e-01  2.29659597e-01  8.47392716e-02
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>   7.84833501e-02  1.17116376e-01 -3.29254012e-02  1.47752258e-01
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>  -5.05408257e-02 -1.03760407e-02 -6.75068207e-02  7.65876531e-02
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>   2.24685014e-01 -4.85771329e-02  9.20202828e-02 -1.39268909e-01
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>  -1.33149834e-01  7.09939469e-02  9.62322284e-03  1.97430345e-01
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>   7.96567200e-02 -2.02657840e-01  9.01385734e-03]
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a> [-6.04410809e-02  1.55657322e-02 -6.76827315e-02  8.16054968e-02
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>   9.60520887e-03 -1.25204605e-01 -6.19064575e-02 -6.01804224e-02
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>   5.45090162e-02  2.06770711e-01  8.75548772e-02  7.76242877e-02
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>   9.78846571e-03 -3.32076578e-02 -2.81371297e-02 -1.04293824e-01
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>  -2.11831322e-01  9.67483947e-02  1.19716602e-02  4.71019153e-02
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>   8.49512245e-03 -9.58052260e-02  1.06920949e-01  1.34581558e-01
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>   1.10775335e-01 -1.21445693e-02 -8.24293321e-03]
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a> [-1.07644203e-01  1.19474816e-01 -1.23425620e-02 -4.76688842e-02
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>  -1.30960013e-01  8.46369514e-02 -2.03250433e-02 -4.67880145e-02
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>  -3.55089096e-02  1.30250049e-01  1.03907897e-02  1.98612609e-01
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>  -9.29014497e-02 -3.78056341e-02  9.92537078e-02  6.86785045e-02
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>   1.28081217e-01  3.12844113e-02 -1.04421485e-01 -1.45493638e-01
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>   2.50604195e-01 -1.04281028e-01  1.41494095e-02 -1.53304959e-02
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>  -2.31537260e-01 -5.91761023e-03 -6.21277588e-02]
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a>...
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>   0.09038222 -0.10695692 -0.02021934 -0.06621559]]
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a>b3 shape (2,):
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>[0. 0.]
</span></code></pre></div> <p>Observe que escolhemos cross_entropy como função de cálculo de loss, devido a isso, devemos ter um output de 2 neurônios, cada um deles diz a chance de uma amostra pertencer a uma classe. Mas a MLP formata isso de modo que no final o resultado fica apenas 1 ou 0 para comparação nos testes</p> <p>Quando usamos model.train, a mlp já toma conta do treinamento sozinho, fazendo todo o processo de forward propagation, loss calculation, backpropagation e atualização de parâmetros. O único problema que encontrei no treinamento foi uma demora excessiva na convergência, isso pode ser explicado pelo eta baixo que foi escolhido. Mas, a solução encontrada foi atualizar o threshold de parada para um valor menor, sem prejudicar a qualidade do modelo.</p> <h1 id=6-estrategia-de-treino-e-teste>6. Estratégia de treino e teste</h1> <p>O dataset foi extraído do Kaggle já em 2 seções, treino e teste (75/25), como pode ser observado na primeira seção desse documento</p> <p>Em relação ao modo de treino foi feito um treinamento em modo estocástico, ou seja, atualiza os pesos em cada amostra. Isso é útil para esse caso, pois esse é o método mais rápido para datasets grandes (100K+ linhas).</p> <p>Ainda, é implementado um método de early stopping para evitir o overfitting, basicamente, analisamos o loss médio de uma janela (parâmetro ajustável) de epochs e verificamos se a o loss atual menos o loss médio dessa janela é menor que um threshold de parada, caso sim, isso indica convergência. Tendo isso em vista, pode-se para o modelo já para evitar o overfitting.</p> <p>Convergência:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>Epoch 0, Loss: 0.162550, Train Acc: 94.72%
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>Epoch 10, Loss: 0.093688, Train Acc: 96.05%
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>Epoch 20, Loss: 0.088143, Train Acc: 96.25%
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>Treinamento encerrado no epoch 27 (convergência detectada).
</span></code></pre></div> <h3 id=implementacao-do-teste>Implementação do teste:</h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=n>preds_test</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>test</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span></code></pre></div> <h1 id=7-curva-de-erro-e-visualizacao>7. Curva de erro e visualização</h1> <h3 id=extraindo-dados-para-avaliar-modelo>Extraindo dados para avaliar modelo:</h3> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>model</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>,</span> <span class=n>plot_confusion</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>plot_roc</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>preds</span><span class=o>=</span><span class=n>preds_test</span><span class=p>)</span>
</span></code></pre></div> <h2 id=resultado>Resultado:</h2> <div class="language-text highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>Accuracy: 96.01%
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>=== Pesos e Biases do Modelo ===
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>Camada 1:
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>  Pesos W1 (shape (32, 27)):
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>[[-5.90536709e-01  4.66615554e-01 -4.49108095e-01  5.21877533e-03
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>   3.25350763e-01  7.17445084e-02 -1.22360259e-02  1.18032302e+00
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>   3.48788226e+00 -1.01996644e-02  4.23905953e-01  2.89380884e-02
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>  -1.68034617e+00 -1.03658232e-01  4.08442980e-01  7.29463962e-01
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>   8.41765767e-02  1.99656636e-01 -3.52814596e-01 -6.00852790e-01
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>   3.88832152e-01 -1.35740680e+00 -2.79580057e-01 -4.19785134e-01
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a>   2.84328537e-01 -9.54605775e-01 -3.50128783e-01]
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a> [ 2.11480807e-01  1.00159878e-01 -3.06430613e-01  1.81622933e-01
</span><span id=__span-15-15><a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a>  -1.74595611e-01  7.60054834e-01 -1.08294362e-01 -6.50388801e-01
</span><span id=__span-15-16><a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a>  -1.00690675e+00  1.99061008e+00  3.52784516e-01  6.80065608e-01
</span><span id=__span-15-17><a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a>   2.42878895e-01 -4.88982385e-02  4.75156172e-01  1.12191729e-01
</span><span id=__span-15-18><a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>  -4.96634271e-01  2.57593430e-01 -3.83644338e-01 -2.87492645e-01
</span><span id=__span-15-19><a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a>   5.30848775e-02 -8.70605540e-01 -3.47258423e-01 -1.41449629e-01
</span><span id=__span-15-20><a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a>   8.23021086e-01 -1.08758530e+00 -3.75258515e-01]
</span><span id=__span-15-21><a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a> [-2.07872079e+00 -1.46026838e-01 -1.58100799e-02 -1.47463794e-01
</span><span id=__span-15-22><a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a>  -3.72018818e-02  2.47253169e-01  4.14674460e-01 -1.79369636e-01
</span><span id=__span-15-23><a id=__codelineno-15-23 name=__codelineno-15-23 href=#__codelineno-15-23></a>  -1.87667054e-01  5.79683551e-01 -3.35868181e-01 -3.13726939e-02
</span><span id=__span-15-24><a id=__codelineno-15-24 name=__codelineno-15-24 href=#__codelineno-15-24></a>  -6.65274745e-01 -4.75407953e-01 -2.27500091e-01  1.13320093e+00
</span><span id=__span-15-25><a id=__codelineno-15-25 name=__codelineno-15-25 href=#__codelineno-15-25></a>   4.41707412e-01 -3.28317828e-02 -6.19415108e-01 -6.24369083e-01
</span><span id=__span-15-26><a id=__codelineno-15-26 name=__codelineno-15-26 href=#__codelineno-15-26></a>...
</span><span id=__span-15-27><a id=__codelineno-15-27 name=__codelineno-15-27 href=#__codelineno-15-27></a>   0.25893154  0.18075803  0.69442195 -0.29597184 -0.38280426 -0.71957644
</span><span id=__span-15-28><a id=__codelineno-15-28 name=__codelineno-15-28 href=#__codelineno-15-28></a>   0.460514   -0.63309972 -0.2926815  -0.44381686]]
</span><span id=__span-15-29><a id=__codelineno-15-29 name=__codelineno-15-29 href=#__codelineno-15-29></a>  Biases b3 (shape (2,)):
</span><span id=__span-15-30><a id=__codelineno-15-30 name=__codelineno-15-30 href=#__codelineno-15-30></a>[ 0.46715727 -0.46715727]
</span></code></pre></div> <h2 id=graficos>Gráficos:</h2> <h3 id=matriz-de-confusao>Matriz de confusão:</h3> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../confusao.jpeg data-desc-position=bottom><img alt=confusao src=../confusao.jpeg></a></p> <h3 id=curva-roc>Curva ROC</h3> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../roc.jpeg data-desc-position=bottom><img alt=roc src=../roc.jpeg></a></p> <h3 id=loss-vs-epoch-accuracy-vs-epoch>Loss VS Epoch / Accuracy VS Epoch</h3> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=../epochs.jpeg data-desc-position=bottom><img alt=epochs src=../epochs.jpeg></a></p> <p>Podemos observar uma clara convergência por essa imagem ainda, platou após 15 epochs aproxidamente.</p> <h1 id=8-avaliacao-do-modelo>8. Avaliação do modelo</h1> <h3 id=olhando-os-dados-brutos>Olhando os dados brutos</h3> <ul> <li>Precision: 0.936</li> <li>Recall: 0.971</li> <li>Accuracy: <strong>96.01%</strong></li> </ul> <p>A matriz de confusão mostra ainda que a taxa de falsos positivos é maior que a taxa de falsos negativos, significando que é menos provável o modelo afirmar que um passageiro saiu satisfeito, quando estava insatisfeito, do que afirmar que ele saiu insatisfeito quando estava satisfeito, que é uma característica desejada.</p> <p>Enquanto isso, a curva ROC mostra que a taxa de verdadeiros positivos é imensamente maior que a de falsos positivos, dando ainda maior validade ao modelo.</p> <p>Por fim, devemos comparar nosso modelo atual com uma baseline para julgarmos a sua efetividade relativa:</p> <h3 id=regressao-logistica>Regressão logística:</h3> <hr> <div class="language-python highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.linear_model</span><span class=w> </span><span class=kn>import</span> <span class=n>LogisticRegression</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>roc_auc_score</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=n>logreg</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>500</span><span class=p>)</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=n>logreg</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=n>preds</span> <span class=o>=</span> <span class=n>logreg</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Accuracy (LogReg):"</span><span class=p>,</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>preds</span><span class=p>))</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=nb>print</span><span class=p>(</span><span class=s2>"AUC:"</span><span class=p>,</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>logreg</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span><span class=mi>1</span><span class=p>]))</span>
</span></code></pre></div> <h3 id=output_1>Output</h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a>Accuracy (LogReg): 0.8717277486910995
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>AUC: 0.9269720121120558
</span></code></pre></div> <p>Nosso modelo apresenta uma acurácia e um AUC (área de baixo do gráfico ROC, capacidade de separar as classes) significativamente maiores que a regressão logística (96% e 0.99 respectivamente). Demonstrando assim que a complexidade extra da rede neural é justificada, ainda, pelo fato de ambos modelos terem bons desempenhos, isso mostra que parte do sinal do nosso modelo é linear, já que a regressão linear segue em partes essa característica.</p> <hr> <h3 id=random-forest>Random forest:</h3> <hr> <div class="language-python highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.ensemble</span><span class=w> </span><span class=kn>import</span> <span class=n>RandomForestClassifier</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=n>rf</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=n>rf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=n>preds</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Accuracy (RandomForest):"</span><span class=p>,</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>preds</span><span class=p>))</span>
</span></code></pre></div> <h3 id=output_2>Output</h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-19-1><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a>Accuracy (RandomForest): 0.963658761934093
</span></code></pre></div> <p>Nosso modelo apresenta uma acurácia análoga a do random forest, que é um modelo consolidade e validado já. Mostrando sua efetividade e mostrando como ele também é bom em capturar não linearidades, que é uma característica chave do random florest.</p> <hr> <h3 id=dummy-aleatorio>Dummy (aleatório):</h3> <hr> <div class="language-python highlight"><pre><span></span><code><span id=__span-20-1><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.dummy</span><span class=w> </span><span class=kn>import</span> <span class=n>DummyClassifier</span>
</span><span id=__span-20-2><a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
</span><span id=__span-20-3><a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=n>dummy</span> <span class=o>=</span> <span class=n>DummyClassifier</span><span class=p>(</span><span class=n>strategy</span><span class=o>=</span><span class=s2>"most_frequent"</span><span class=p>)</span>
</span><span id=__span-20-4><a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=n>dummy</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span><span id=__span-20-5><a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=nb>print</span><span class=p>(</span><span class=s2>"Accuracy (Dummy):"</span><span class=p>,</span> <span class=n>dummy</span><span class=o>.</span><span class=n>score</span><span class=p>(</span><span class=n>X_test</span><span class=p>,</span> <span class=n>y_test</span><span class=p>))</span>
</span></code></pre></div> <h3 id=output_3>Output</h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-21-1><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>Accuracy (Dummy): 0.5610178626424391
</span></code></pre></div> <p>Nosso modelo tem uma acurácia significativamente maior do que a dummy, que é essencialmente favorecer a classe majoritária (que tem mais quantidade numérica). Mostrando assim que nosso modelo é independente da sorte e está acima do baseline nulo</p> <hr> <h1 id=funcao-de-plot-auxiliar>Função de plot auxiliar:</h1> <div class="language-python highlight"><pre><span></span><code><span id=__span-22-1><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-22-2><a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-22-3><a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
</span><span id=__span-22-4><a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-22-5><a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>
</span><span id=__span-22-6><a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=k>def</span><span class=w> </span><span class=nf>remove_unused_axes</span><span class=p>(</span><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=n>used</span><span class=p>):</span>
</span><span id=__span-22-7><a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=w>    </span><span class=sd>"""Remove eixos não usados (vazios) do figure."""</span>
</span><span id=__span-22-8><a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>used</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>axes</span><span class=p>)):</span>
</span><span id=__span-22-9><a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>        <span class=n>fig</span><span class=o>.</span><span class=n>delaxes</span><span class=p>(</span><span class=n>axes</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span><span id=__span-22-10><a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>
</span><span id=__span-22-11><a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=k>def</span><span class=w> </span><span class=nf>plot_distributions</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>quantitative_cols</span><span class=p>,</span> <span class=n>ordinal_cols</span><span class=p>,</span> <span class=n>nominal_cols</span><span class=p>,</span>
</span><span id=__span-22-12><a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a>                       <span class=n>title_suffix</span><span class=o>=</span><span class=s2>""</span><span class=p>,</span> <span class=n>force_ordinal_continuous</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
</span><span id=__span-22-13><a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a>                       <span class=n>delay_log_scale</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span><span id=__span-22-14><a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a><span class=w>    </span><span class=sd>"""</span>
</span><span id=__span-22-15><a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a><span class=sd>    Plota distribuições. </span>
</span><span id=__span-22-16><a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a><span class=sd>    *********************ATENÇÃO:*********************</span>
</span><span id=__span-22-17><a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a><span class=sd>    Para colunas de 'delay' aplicamos np.log1p(clip(lower=0))</span>
</span><span id=__span-22-18><a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a><span class=sd>    para PRESERVAR zeros e comprimir caudas (equivalente a log(1+x)). Log(0) não existe, não podemos ignorar a maioria dos dados.</span>
</span><span id=__span-22-19><a id=__codelineno-22-19 name=__codelineno-22-19 href=#__codelineno-22-19></a><span class=sd>    """</span>
</span><span id=__span-22-20><a id=__codelineno-22-20 name=__codelineno-22-20 href=#__codelineno-22-20></a>    <span class=n>sns</span><span class=o>.</span><span class=n>set_style</span><span class=p>(</span><span class=s2>"white"</span><span class=p>)</span>
</span><span id=__span-22-21><a id=__codelineno-22-21 name=__codelineno-22-21 href=#__codelineno-22-21></a>
</span><span id=__span-22-22><a id=__codelineno-22-22 name=__codelineno-22-22 href=#__codelineno-22-22></a>    <span class=k>if</span> <span class=n>quantitative_cols</span><span class=p>:</span>
</span><span id=__span-22-23><a id=__codelineno-22-23 name=__codelineno-22-23 href=#__codelineno-22-23></a>        <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>quantitative_cols</span><span class=p>)</span>
</span><span id=__span-22-24><a id=__codelineno-22-24 name=__codelineno-22-24 href=#__codelineno-22-24></a>        <span class=n>n_cols</span> <span class=o>=</span> <span class=mi>3</span>
</span><span id=__span-22-25><a id=__codelineno-22-25 name=__codelineno-22-25 href=#__codelineno-22-25></a>        <span class=n>n_rows</span> <span class=o>=</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=n>n_cols</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=n>n_cols</span>
</span><span id=__span-22-26><a id=__codelineno-22-26 name=__codelineno-22-26 href=#__codelineno-22-26></a>        <span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>n_rows</span><span class=p>,</span> <span class=n>n_cols</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=n>n_cols</span><span class=o>*</span><span class=mi>5</span><span class=p>,</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_rows</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-22-27><a id=__codelineno-22-27 name=__codelineno-22-27 href=#__codelineno-22-27></a>        <span class=n>axes</span> <span class=o>=</span> <span class=n>axes</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span><span id=__span-22-28><a id=__codelineno-22-28 name=__codelineno-22-28 href=#__codelineno-22-28></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>quantitative_cols</span><span class=p>):</span>
</span><span id=__span-22-29><a id=__codelineno-22-29 name=__codelineno-22-29 href=#__codelineno-22-29></a>            <span class=n>ax</span> <span class=o>=</span> <span class=n>axes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-22-30><a id=__codelineno-22-30 name=__codelineno-22-30 href=#__codelineno-22-30></a>            <span class=n>series</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>],</span> <span class=n>errors</span><span class=o>=</span><span class=s2>"coerce"</span><span class=p>)</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span><span id=__span-22-31><a id=__codelineno-22-31 name=__codelineno-22-31 href=#__codelineno-22-31></a>            <span class=k>if</span> <span class=n>delay_log_scale</span> <span class=ow>and</span> <span class=s2>"delay"</span> <span class=ow>in</span> <span class=n>col</span><span class=o>.</span><span class=n>lower</span><span class=p>():</span>
</span><span id=__span-22-32><a id=__codelineno-22-32 name=__codelineno-22-32 href=#__codelineno-22-32></a>                <span class=n>series_plot</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>log1p</span><span class=p>(</span><span class=n>series</span><span class=o>.</span><span class=n>clip</span><span class=p>(</span><span class=n>lower</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span>
</span><span id=__span-22-33><a id=__codelineno-22-33 name=__codelineno-22-33 href=#__codelineno-22-33></a>                <span class=n>sns</span><span class=o>.</span><span class=n>histplot</span><span class=p>(</span><span class=n>series_plot</span><span class=p>,</span> <span class=n>kde</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s2>"percent"</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>40</span><span class=p>)</span>
</span><span id=__span-22-34><a id=__codelineno-22-34 name=__codelineno-22-34 href=#__codelineno-22-34></a>                <span class=n>ax</span><span class=o>.</span><span class=n>set_xlabel</span><span class=p>(</span><span class=sa>f</span><span class=s2>"</span><span class=si>{</span><span class=n>col</span><span class=si>}</span><span class=s2> (log1p)"</span><span class=p>)</span>
</span><span id=__span-22-35><a id=__codelineno-22-35 name=__codelineno-22-35 href=#__codelineno-22-35></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-22-36><a id=__codelineno-22-36 name=__codelineno-22-36 href=#__codelineno-22-36></a>                <span class=n>sns</span><span class=o>.</span><span class=n>histplot</span><span class=p>(</span><span class=n>series</span><span class=p>,</span> <span class=n>kde</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s2>"percent"</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>40</span><span class=p>)</span>
</span><span id=__span-22-37><a id=__codelineno-22-37 name=__codelineno-22-37 href=#__codelineno-22-37></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=n>col</span><span class=p>)</span>
</span><span id=__span-22-38><a id=__codelineno-22-38 name=__codelineno-22-38 href=#__codelineno-22-38></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>"Percent"</span><span class=p>)</span>
</span><span id=__span-22-39><a id=__codelineno-22-39 name=__codelineno-22-39 href=#__codelineno-22-39></a>            <span class=n>ax</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s2>"x"</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-22-40><a id=__codelineno-22-40 name=__codelineno-22-40 href=#__codelineno-22-40></a>        <span class=n>remove_unused_axes</span><span class=p>(</span><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>quantitative_cols</span><span class=p>))</span>
</span><span id=__span-22-41><a id=__codelineno-22-41 name=__codelineno-22-41 href=#__codelineno-22-41></a>        <span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Distribuição das Variáveis Quantitativas </span><span class=si>{</span><span class=n>title_suffix</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mf>1.02</span><span class=p>)</span>
</span><span id=__span-22-42><a id=__codelineno-22-42 name=__codelineno-22-42 href=#__codelineno-22-42></a>        <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>();</span> <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-22-43><a id=__codelineno-22-43 name=__codelineno-22-43 href=#__codelineno-22-43></a>
</span><span id=__span-22-44><a id=__codelineno-22-44 name=__codelineno-22-44 href=#__codelineno-22-44></a>    <span class=c1># --- Ordinais ---</span>
</span><span id=__span-22-45><a id=__codelineno-22-45 name=__codelineno-22-45 href=#__codelineno-22-45></a>    <span class=k>if</span> <span class=n>ordinal_cols</span><span class=p>:</span>
</span><span id=__span-22-46><a id=__codelineno-22-46 name=__codelineno-22-46 href=#__codelineno-22-46></a>        <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ordinal_cols</span><span class=p>)</span>
</span><span id=__span-22-47><a id=__codelineno-22-47 name=__codelineno-22-47 href=#__codelineno-22-47></a>        <span class=n>n_cols</span> <span class=o>=</span> <span class=mi>3</span>
</span><span id=__span-22-48><a id=__codelineno-22-48 name=__codelineno-22-48 href=#__codelineno-22-48></a>        <span class=n>n_rows</span> <span class=o>=</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=n>n_cols</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=n>n_cols</span>
</span><span id=__span-22-49><a id=__codelineno-22-49 name=__codelineno-22-49 href=#__codelineno-22-49></a>        <span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>n_rows</span><span class=p>,</span> <span class=n>n_cols</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=n>n_cols</span><span class=o>*</span><span class=mi>5</span><span class=p>,</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_rows</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-22-50><a id=__codelineno-22-50 name=__codelineno-22-50 href=#__codelineno-22-50></a>        <span class=n>axes</span> <span class=o>=</span> <span class=n>axes</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span><span id=__span-22-51><a id=__codelineno-22-51 name=__codelineno-22-51 href=#__codelineno-22-51></a>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>ordinal_cols</span><span class=p>):</span>
</span><span id=__span-22-52><a id=__codelineno-22-52 name=__codelineno-22-52 href=#__codelineno-22-52></a>            <span class=n>ax</span> <span class=o>=</span> <span class=n>axes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-22-53><a id=__codelineno-22-53 name=__codelineno-22-53 href=#__codelineno-22-53></a>            <span class=n>coerced</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_numeric</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>],</span> <span class=n>errors</span><span class=o>=</span><span class=s2>"coerce"</span><span class=p>)</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span><span id=__span-22-54><a id=__codelineno-22-54 name=__codelineno-22-54 href=#__codelineno-22-54></a>            <span class=k>if</span> <span class=n>force_ordinal_continuous</span><span class=p>:</span>
</span><span id=__span-22-55><a id=__codelineno-22-55 name=__codelineno-22-55 href=#__codelineno-22-55></a>                <span class=n>sns</span><span class=o>.</span><span class=n>histplot</span><span class=p>(</span><span class=n>coerced</span><span class=p>,</span> <span class=n>kde</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span> <span class=n>stat</span><span class=o>=</span><span class=s2>"percent"</span><span class=p>,</span> <span class=n>bins</span><span class=o>=</span><span class=mi>40</span><span class=p>)</span>
</span><span id=__span-22-56><a id=__codelineno-22-56 name=__codelineno-22-56 href=#__codelineno-22-56></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-22-57><a id=__codelineno-22-57 name=__codelineno-22-57 href=#__codelineno-22-57></a>                <span class=n>counts</span> <span class=o>=</span> <span class=n>coerced</span><span class=o>.</span><span class=n>value_counts</span><span class=p>(</span><span class=n>normalize</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>sort_index</span><span class=p>()</span> <span class=o>*</span> <span class=mi>100</span>
</span><span id=__span-22-58><a id=__codelineno-22-58 name=__codelineno-22-58 href=#__codelineno-22-58></a>                <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>counts</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>),</span> <span class=n>y</span><span class=o>=</span><span class=n>counts</span><span class=o>.</span><span class=n>values</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>)</span>
</span><span id=__span-22-59><a id=__codelineno-22-59 name=__codelineno-22-59 href=#__codelineno-22-59></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=n>col</span><span class=p>)</span>
</span><span id=__span-22-60><a id=__codelineno-22-60 name=__codelineno-22-60 href=#__codelineno-22-60></a>            <span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>"Percent"</span><span class=p>)</span>
</span><span id=__span-22-61><a id=__codelineno-22-61 name=__codelineno-22-61 href=#__codelineno-22-61></a>            <span class=n>ax</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s2>"x"</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-22-62><a id=__codelineno-22-62 name=__codelineno-22-62 href=#__codelineno-22-62></a>        <span class=n>remove_unused_axes</span><span class=p>(</span><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>ordinal_cols</span><span class=p>))</span>
</span><span id=__span-22-63><a id=__codelineno-22-63 name=__codelineno-22-63 href=#__codelineno-22-63></a>        <span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Distribuição das Variáveis Ordinais </span><span class=si>{</span><span class=n>title_suffix</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mf>1.02</span><span class=p>)</span>
</span><span id=__span-22-64><a id=__codelineno-22-64 name=__codelineno-22-64 href=#__codelineno-22-64></a>        <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>();</span> <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span><span id=__span-22-65><a id=__codelineno-22-65 name=__codelineno-22-65 href=#__codelineno-22-65></a>
</span><span id=__span-22-66><a id=__codelineno-22-66 name=__codelineno-22-66 href=#__codelineno-22-66></a>    <span class=c1># --- Nominais ---</span>
</span><span id=__span-22-67><a id=__codelineno-22-67 name=__codelineno-22-67 href=#__codelineno-22-67></a>    <span class=k>if</span> <span class=n>nominal_cols</span><span class=p>:</span>
</span><span id=__span-22-68><a id=__codelineno-22-68 name=__codelineno-22-68 href=#__codelineno-22-68></a>        <span class=c1># se lista vazia ou None, pula todo o bloco (evita n_rows=0)</span>
</span><span id=__span-22-69><a id=__codelineno-22-69 name=__codelineno-22-69 href=#__codelineno-22-69></a>        <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>nominal_cols</span><span class=p>)</span>
</span><span id=__span-22-70><a id=__codelineno-22-70 name=__codelineno-22-70 href=#__codelineno-22-70></a>        <span class=k>if</span> <span class=n>n</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-22-71><a id=__codelineno-22-71 name=__codelineno-22-71 href=#__codelineno-22-71></a>            <span class=n>n_cols</span> <span class=o>=</span> <span class=mi>3</span>
</span><span id=__span-22-72><a id=__codelineno-22-72 name=__codelineno-22-72 href=#__codelineno-22-72></a>            <span class=n>n_rows</span> <span class=o>=</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=n>n_cols</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>//</span> <span class=n>n_cols</span>
</span><span id=__span-22-73><a id=__codelineno-22-73 name=__codelineno-22-73 href=#__codelineno-22-73></a>            <span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=n>n_rows</span><span class=p>,</span> <span class=n>n_cols</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=n>n_cols</span><span class=o>*</span><span class=mi>5</span><span class=p>,</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n_rows</span><span class=p>)</span><span class=o>*</span><span class=mi>4</span><span class=p>))</span>
</span><span id=__span-22-74><a id=__codelineno-22-74 name=__codelineno-22-74 href=#__codelineno-22-74></a>            <span class=n>axes</span> <span class=o>=</span> <span class=n>axes</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span><span id=__span-22-75><a id=__codelineno-22-75 name=__codelineno-22-75 href=#__codelineno-22-75></a>            <span class=n>used</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-22-76><a id=__codelineno-22-76 name=__codelineno-22-76 href=#__codelineno-22-76></a>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>nominal_cols</span><span class=p>):</span>
</span><span id=__span-22-77><a id=__codelineno-22-77 name=__codelineno-22-77 href=#__codelineno-22-77></a>                <span class=n>ax</span> <span class=o>=</span> <span class=n>axes</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-22-78><a id=__codelineno-22-78 name=__codelineno-22-78 href=#__codelineno-22-78></a>                <span class=n>counts</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>col</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>str</span><span class=p>)</span><span class=o>.</span><span class=n>value_counts</span><span class=p>(</span><span class=n>dropna</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-22-79><a id=__codelineno-22-79 name=__codelineno-22-79 href=#__codelineno-22-79></a>                <span class=n>labels</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>counts</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span><span id=__span-22-80><a id=__codelineno-22-80 name=__codelineno-22-80 href=#__codelineno-22-80></a>                <span class=n>sns</span><span class=o>.</span><span class=n>barplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>labels</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=p>(</span><span class=n>counts</span><span class=o>/</span><span class=n>counts</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>*</span><span class=mi>100</span><span class=p>)</span><span class=o>.</span><span class=n>values</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>)</span>
</span><span id=__span-22-81><a id=__codelineno-22-81 name=__codelineno-22-81 href=#__codelineno-22-81></a>                <span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=n>col</span><span class=p>)</span>
</span><span id=__span-22-82><a id=__codelineno-22-82 name=__codelineno-22-82 href=#__codelineno-22-82></a>                <span class=n>ax</span><span class=o>.</span><span class=n>set_ylabel</span><span class=p>(</span><span class=s2>"Percent"</span><span class=p>)</span>
</span><span id=__span-22-83><a id=__codelineno-22-83 name=__codelineno-22-83 href=#__codelineno-22-83></a>                <span class=n>ax</span><span class=o>.</span><span class=n>tick_params</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=s2>"x"</span><span class=p>,</span> <span class=n>rotation</span><span class=o>=</span><span class=mi>45</span><span class=p>)</span>
</span><span id=__span-22-84><a id=__codelineno-22-84 name=__codelineno-22-84 href=#__codelineno-22-84></a>                <span class=n>used</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-22-85><a id=__codelineno-22-85 name=__codelineno-22-85 href=#__codelineno-22-85></a>            <span class=n>remove_unused_axes</span><span class=p>(</span><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span><span class=p>,</span> <span class=n>used</span><span class=p>)</span>
</span><span id=__span-22-86><a id=__codelineno-22-86 name=__codelineno-22-86 href=#__codelineno-22-86></a>            <span class=n>fig</span><span class=o>.</span><span class=n>suptitle</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Distribuição das Variáveis Nominais </span><span class=si>{</span><span class=n>title_suffix</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=n>fontsize</span><span class=o>=</span><span class=mi>16</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mf>1.02</span><span class=p>)</span>
</span><span id=__span-22-87><a id=__codelineno-22-87 name=__codelineno-22-87 href=#__codelineno-22-87></a>            <span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>();</span> <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 6, 2025 02:35:14 UTC">October 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 6, 2025 02:35:14 UTC">October 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:felipebns@al.insper.edu.br>felipebns</a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../../assets/_markdown_exec_pyodide.js></script> <script src=https://unpkg.com/mathjax/es5/tex-mml-chtml.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js></script> <script src=https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js></script> <script src=../../../assets/javascripts/badge.js async></script> <script src=../../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>